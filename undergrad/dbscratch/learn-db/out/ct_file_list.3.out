{"status":"success","data":[
	{
		"created": "2021-01-04T21:33:40.36898+0000",
		"homework_id": "da8b4400-1eff-4557-92ca-462aad987b31",
		"homework_no": "91",
		"homework_title": "Create Tabel",
		"lesson_body": "{\"sample\": 1, \"sql_test\": \"select s01_test() as X\", \"test_type\": \"sql\", \"lesson_text\": \"Some \u003ci\u003e\u003cb\u003eLesson\u003c/b\u003e\u003c/i\u003e Text 1\"}",
		"points_avail": 10,
		"updated": null,
		"video_img": "1.png",
		"video_url": "1.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.36898+0000",
		"homework_id": "8feb7718-e9dd-433d-a55b-d398af9d721e",
		"homework_no": "92",
		"homework_title": "Select From",
		"lesson_body": "{\"sample\": 2, \"lesson_text\": \"Some Lesson Text 2\"}",
		"points_avail": 10,
		"updated": null,
		"video_img": "2.png",
		"video_url": "2.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.36898+0000",
		"homework_id": "8382492f-cdad-4601-924a-6c3cdf370390",
		"homework_no": "93",
		"homework_title": "Select Where",
		"lesson_body": "{\"sample\": 3, \"lesson_text\": \"Some Lesson Text 3\"}",
		"points_avail": 10,
		"updated": null,
		"video_img": "3.png",
		"video_url": "3.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.37292+0000",
		"homework_id": "103a5e86-c3cd-40a7-54df-7b9295aeeea8",
		"homework_no": "1",
		"homework_title": " Interactive - 01 - Create Table",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 01 - Create Table\\n\\nCreate a table with 3 columns.  The table name will be \\\"name_list\\\".\\nThe columns are:\\n\\n- real_name a text column\\n- age an integer\\n- state a 2 character field for a US state code.\\n\\n```\\ncreate table \u003cname\u003e (\\n\\t\u003ccolumn\u003e,\\t\\n\\t\u003ccolumn\u003e,\\t\\n\\t\u003ccolumn\u003e,\\t\\n\\t...\\n\\t\u003ccolumn\u003e\\n);\\n```\\nThe columns are a comma `,` separated list.   The set of\\ncolumns tars with a `(` and ends with a `)`.\\n\\nA `;` (semicolon) is used to mark the end of the statement.\\n\\nOfficially this is call the Data Definition Language or DDL.\\n\\nWe have to declare what we want to store before storing it.\\n\\nWe will get back to data-types and SQL in a future homework.\\n\\nso with 3 columns\\n\\n```\\n\\nCREATE TABLE name_list (\\n\\treal_name text,\\t\\n\\tage int,\\t\\n\\tstate varchar(2)\\n);\\n\\n\\n```\\n\\nBook: Pages 5 to 7\\n\\n\\n\\n\\n#### Tags: \\\"create table\\\",\\\"type text\\\",\\\"type int\\\",\\\"type varchar\\\",\\\"hw01\\\"\\n\\n\\n\", \"Lesson_no\": 1}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.3915+0000",
		"video_img": "hw01.jpg",
		"video_url": "hw01.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.39399+0000",
		"homework_id": "0d1ad7cf-ef0d-4dbb-7b68-f342869e5ace",
		"homework_no": "2",
		"homework_title": " Interactive - 02 - Insert data into \"name_list\"",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 02 - Insert data into \\\"name_list\\\"\\n\\nInsert some data into the table.  \\n\\n```\\ninsert into \u003cname\u003e ( \u003ccolumn-name\u003e, \u003ccolumn-name\u003e, .... ) values\\n\\t( \u003ccolun-data1\u003e, \u003ccolun-data2\u003e, ... ),\\n\\t( \u003ccolun-row2\u003e, \u003ccolun-row2\u003e, ... ),\\n\\t( \u003ccolun-row2\u003e, \u003ccolun-row2\u003e, ... )\\n;\\n```\\n\\nso our example, we will use all the columns so we can leave the\\nlist of columns out  and just put the data in the table declared\\norder.\\n\\n```\\nINSERT INTO name_list values\\n\\t( 'bob true',            22, 'WY' ),\\n\\t( 'Jane True',           20, 'WY' ),\\n\\t( 'Tom Ace',             31, 'NJ' ),\\n\\t( 'Steve Pen',           33, 'NJ' ),\\n\\t( 'Laura Jean Alkinoos', 34, 'PA' )\\n;\\n\\n```\\n\\nand a single row (note that the column order\\nis chained).  It is better to list the columns\\nso that if the table is changed the data can\\nstill be loaded.  It is possible to add new columns to a table\\nand break old code - so it is better to have:\\n\\n```\\ninsert into name_list ( real_name, age, state ) values\\n\\t( 'bob true',            22, 'WY' ),\\n\\t( 'Jane True',           20, 'WY' ),\\n\\t( 'Tom Ace',             31, 'NJ' ),\\n\\t( 'Steve Pen',           33, 'NJ' ),\\n\\t( 'Laura Jean Alkinoos', 34, 'PA' )\\n;\\n```\\n\\nAlso note that it is intentional at this point that `bob true` is all lower\\ncase.  We will fix that in a little bit.\\n\\n```\\n\\nINSERT INTO name_list ( real_name, state, age )\\n\\tvalues\\t( 'Philip Schlump', 'WY', 62 );\\n\\n```\\n\\nEach set of data that we inset is separated with a comma, `,`.\\nWhen we insert text we use single quotes, `'` to mark that it is\\ntext.  To insert a quote mark we put in 2 of them in a row.\\nSo, To insert `that's`  we would use in our insert statement,\\n`'that''s``.\\n\\nNumbers are respresented as a set of digits.  With fractional(floating point) numbers you put in a decimal\\npoint - but note that our column age is not a float - so just whole years.\\n\\n\\n\\n\\nBook: Pages 7 to 9\\n\\n#### Tags: \\\"hw02\\\",\\\"insert\\\"    \\t\\n\\n\\n\", \"Lesson_no\": 2}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.40202+0000",
		"video_img": "hw02.jpg",
		"video_url": "hw02.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.40378+0000",
		"homework_id": "62cd3e1e-cb68-478c-435d-014eb1eca4ec",
		"homework_no": "3",
		"homework_title": " Interactive - 03 - Select data back from the table",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 03 - Select data back from the table\\n\\nData is more fun when you can put some in and get it \\nback later.  Enter \\\"select\\\".\\n\\n```\\nSELECT * from name_list;\\n\\n```\\n\\ngives you get back all the data.  The `*` is the list\\nof columns you get back.  `*` is for all the columns.\\n\\n```\\nSELECT real_name, state from name_list;\\n\\n```\\n\\nGives you back just the name and state.\\n\\n```\\n\\nSELECT lower(real_name) as \\\"real_name_lower\\\", real_name\\nfrom name_list;\\n\\n```\\n\\nGives you back a lower case version of the name.\\n\\nOr make it in order from z to a.\\n\\n```\\n\\nSELECT lower(real_name) as \\\"real_name_lower\\\", real_name\\n\\tfrom name_list\\n\\torder by 1 desc\\n;\\n\\n```\\n\\nMaybe we just want the names in Wyoming.  This is the\\nwhere clause.\\n\\n```\\n\\nSELECT real_name\\n\\tFROM name_list\\n\\tWHERE state = 'WY'\\n;\\n\\n```\\n\\nRemember that if you want to match a text field you\\nhave to use quotes.  Also it is case sensitive.\\n\\n```\\nselect real_name\\nfrom name_list\\nwhere state = 'wy'\\n;\\n```\\n\\nwill not give you any rows.  Try it.\\n\\n#### Tags: select,where \\n\", \"Lesson_no\": 3}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.41004+0000",
		"video_img": "hw03.jpg",
		"video_url": "hw03.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.41192+0000",
		"homework_id": "d76c8ea7-f73f-4ecf-4236-205238d35a83",
		"homework_no": "4",
		"homework_title": " Interactive - 04 - update the table",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 04 - update the table\\n\\nNote that we have an error in our data.  `Bob true` should\\nbe `Bob True`.   Let's change some data.\\n\\n```\\nupdate \u003ctabe-name\u003e\\n\\tset \u003clist of columns to modify\u003e\\n\\twhere \u003cboolean expresison\u003e\\n;\\n```\\n\\nso... let's look at the data before the update\\n\\n```\\nSELECT * from name_list;\\n\\n```\\n\\nUpdate it to fix it\\n\\n```\\nUPDATE name_list\\n\\tSET real_name = 'Bob True'\\n\\tWHERE real_name = 'bob true'\\n;\\n\\n```\\n\\nNow let's look at the data:\\n\\n```\\nSELECT * from name_list;\\n\\n```\\n\\nMuch better!\\n\\n\\nBook: page 139\\n\\n#### Tags: update,where\\n\", \"Lesson_no\": 4}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.41732+0000",
		"video_img": "hw04.jpg",
		"video_url": "hw04.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.41908+0000",
		"homework_id": "c2dd76e4-357d-4c03-4dcf-c0b5509b2b51",
		"homework_no": "5",
		"homework_title": " Interactive - 05 - insert more data / select unique data",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 05 - insert more data / select unique data\\n\\nLet's put in some more data - that has some mistakes in it.\\n\\n\\n```\\nINSERT INTO name_list values\\n\\t( 'Liz Trubune',         30, 'WY' ),\\n\\t( 'Jane True',           20, 'WY' ),\\n\\t( 'Lary Smith',          58, 'NJ' ),\\n\\t( 'Dave Dave',           21, 'NJ' ),\\n\\t( 'Laura Ann Alkinoos',  34, 'PA' )\\n;\\n\\n\\n```\\n\\nThe problem is that \\\"Jane True\\\" is now a duplicate!\\n\\nLet's see it.\\n\\n```\\n\\nSELECT * from name_list;\\n\\n\\n```\\n\\nWe will get how to prevent this later.\\nRight now let's get unique data back when the\\nactual data has duplicates.   For lots of reasons you \\ncan get duplicates in a set of selected data.\\n\\n```\\nSELECT distinct * from name_list;\\n\\n```\\n\\nBook: pages 12 to 14.\\n\\n#### Tags: insert,select,distinct,select distinct\\n\", \"Lesson_no\": 5}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.42852+0000",
		"video_img": "hw05.jpg",
		"video_url": "hw05.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.43061+0000",
		"homework_id": "fd0be3ef-ca0c-48ba-5f75-9b1a4cecb73e",
		"homework_no": "6",
		"homework_title": " Interactive - 06 - count rows of data",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 06 - count rows of data\\n\\nuse count to get how many rows.\\n\\n```\\nSELECT count(*) from name_list;\\n\\n```\\n\\nYou should get 11 rows.\\n\\nor with a where clause\\n\\n```\\n\\nSELECT count(*) from name_list\\nwhere state = 'NJ'\\n;\\n\\n```\\n\\nYou should get 4 rows.\\n\\nwith a name for the returned data column\\n\\n```\\n\\nSELECT count(*) as \\\"count_of_names\\\"\\n\\tFROM name_list\\n;\\n\\n```\\n\\nYou should get 10 rows.\\n\\nBook: page 117 to 118\\n\\n``` \\n\\nSELECT count(distinct real_name) \\n\\tFROM name_list\\n\\tWHERE state = 'NJ'\\n;\\n\\n```\\n\\n#### Tags: count,distinct,\\\"count distinct\\\"\\n\", \"Lesson_no\": 6}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.44041+0000",
		"video_img": "hw06.jpg",
		"video_url": "hw06.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.4423+0000",
		"homework_id": "3cbca434-c8d8-442c-48b6-01fd4b16eea4",
		"homework_no": "7",
		"homework_title": " Interactive - 07 - add a check constraint on age",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 07 - add a check constraint on age\\n\\nWe can use the Data Definition Language (DDL) - create table to check\\nthat values are in a correct range or value.\\n\\nThese are check constrains.\\n\\nLet's save our data for later, then recreate the table.\\n\\nFirst we are going to rename the table - so we can save \\nit for later.\\n\\n```\\nALTER TABLE name_list\\n\\tRENAME TO old_name_list;\\n```\\n\\n\\nNow we will re-create the table with the check constraint.\\n\\n```\\ncreate table name_list (\\n\\treal_name text,\\n\\tage int check ( age \u003e 0 and age \u003c 154 ),\\t\\n\\tstate char varying (2)\\n);\\n\\n```\\n\\nNow copy the data back.  \\n\\n```\\ninsert into name_list ( real_name, age, state ) \\n\\tselect real_name, age, state \\n\\tfrom old_name_list;\\n```\\n\\nVerify data amount.  Check how many rows.\\n\\n```\\nselect count(1) from name_list;\\nselect count(1) from old_name_list;\\n```\\n\\nProvided that the counts are the same let's clean up the temporary table with the old data. \\n\\n```\\ndrop table old_name_list;\\n```\\n\\nAnd let's look at the data.\\n\\n\\n```\\nselect * from name_list;\\n```\\n\\n#### Tags: \\\"alter table rename\\\",\\\"rename\\\",\\\"insert\\\",\\\"drop table\\\",\\\"insert select\\\"\\n\", \"Lesson_no\": 7}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.4563+0000",
		"video_img": "hw07.jpg",
		"video_url": "hw07.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.45848+0000",
		"homework_id": "f52169d8-180a-4ee5-6c5e-676e2b8cb6ca",
		"homework_no": "8",
		"homework_title": " Interactive - 08 - create unique id and a primary key ",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 08 - create unique id and a primary key \\n\\nIt is really hard to update data when you don't have a unique way of identifying a row.\\nPeople will often imagine that there is something unique in the data.  Some combination\\nof name/date/place-of-birth, generally it is not true.\\n\\nThe easy way to deal with this is to create unique keys.  PostgreSQL offers two ways \\nof doing this.  The first is a key that counts up.   This makes short keys, that's good\\nbut also creates a bottle neck with a single source of \\\"count-up\\\" values.  The second\\nway is use a university unique identifier or UUID.  UUIDs are can be created in parallel\\nand will not collide.  This has lot's of advantages, but they are long, hard to type\\nand take up lots of space in your database.\\n\\nWe will get back to sequential values later, for a different purpose.  Let's do the\\nmore general approach and use UUIDs.\\n\\nWe are going to change our table to have a unique ID column, then create an index \\non that column.\\n\\nThis relies on having a way to generate UUIDs, it is an extension package to the\\ndefault Postgres database. (double quotes, `\\\"` are correct for this command).\\n\\n```\\nCREATE EXTENSION IF NOT EXISTS \\\"uuid-ossp\\\";\\n\\n```\\n\\nThere are ways to add a column to the table without re-creating the table.\\nThey will not work for this.\\n\\nLet's save our data for later, then recreate the table.\\n\\nFirst we are going to rename the table, so we can save \\nit for later. (Familiar, we did this last time)\\n\\n```\\nALTER TABLE name_list\\n\\tRENAME TO old_name_list;\\n```\\n\\n\\nNow we will re-create the table with the check constraint.\\n\\n```\\ncreate table name_list (\\n\\tname_list_id UUID NOT NULL DEFAULT uuid_generate_v4() primary key,\\n\\treal_name text,\\n\\tage int check ( age \u003e 0 and age \u003c 154 ),\\t\\n\\tstate char varying (2)\\n);\\n\\n```\\n\\nNow copy the data back.\\n\\n```\\ninsert into name_list ( real_name, age, state ) \\n\\tselect real_name, age, state \\n\\tfrom old_name_list;\\n```\\n\\nVerify data amount.  Check how many rows.\\n\\n```\\nselect count(1) from name_list;\\nselect count(1) from old_name_list;\\n```\\n\\nProvided that the counts are the same let's clean up the temporary table with the old data. \\n\\n\\n```\\ndrop table old_name_list;\\n```\\n\\nThere are 2 parts that we added.  Both a ID column that is unique and\\na thing called a `PRIMARY KEY`.\\n\\n\\nYour result should be similar to this list (the name_list_id's will\\nbe unique).\\n\\n\\n```\\n             name_list_id             |      real_name      | age | state \\n--------------------------------------+---------------------+-----+-------\\n 1fb069ca-a4a2-412a-8401-c835b6c45cb7 | Jane True           |  20 | WY\\n 39fff492-f369-4552-bf49-b8d7ae57bf9a | Tom Ace             |  31 | NJ\\n 8e91d65f-ee0a-4642-8d62-1cc1e1058238 | Steve Pen           |  33 | NJ\\n e245b3ec-9e5f-4112-ac7e-1d9732d9a4f1 | Laura Jean Alkinoos |  34 | PA\\n b8c2468e-694d-46de-acc3-e8da239aa1a3 | Philip Schlump      |  62 | WY\\n 983b17d2-39f7-45bc-96b2-66ffdbb96c0e | Bob True            |  22 | WY\\n 2db6af28-47c7-4107-9b67-bdec3321f14c | Liz Trubune         |  30 | WY\\n ea51c6b2-37f0-47ed-9211-d1064d3eacfd | Jane True           |  44 | WY\\n 4c827537-1755-4242-8241-a77ff4173554 | Lary Smith          |  58 | NJ\\n 3674b39d-4a61-45e0-99e6-65fb7edbbf82 | Dave Dave           |  21 | NJ\\n e543c622-24be-4cc2-8241-e8a2dfd1f15c | Laura Ann Alkinoos  |  34 | PA\\n(11 rows)\\n\\n```\\n\\n#### Tags: \\\"primary key\\\",\\\"uuid\\\",\\\"unique id\\\",\\\"UUID\\\"\\n\\n\", \"Lesson_no\": 8}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.47041+0000",
		"video_img": "hw08.jpg",
		"video_url": "hw08.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.47268+0000",
		"homework_id": "b2af745c-ab4b-4ffc-4852-535139741388",
		"homework_no": "9",
		"homework_title": " Interactive - 09 - add a table with state codes",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 09 - add a table with state codes\\n\\nA check constraint on all the state codes would be very long.   There are also\\ntimes when that is just not the best way to check that a value is correct.\\n\\nThere is a different way to check that a value is in a range of values.\\nThat is to add a new table that contains all the values and have the\\ndatabase verify that new values are in this list.\\n\\nFirst let's create the table with the values.  We can also have the\\ndatabase verify that nobody puts in an empty state name.  This is\\nthe \\\"NOT NULL\\\" on each of the types.\\n\\n```\\nCREATE TABLE us_state (\\n\\tstate_id UUID NOT NULL DEFAULT uuid_generate_v4() primary key,\\n\\tstate_name text NOT NULL,\\n\\tstate char varying (2) NOT NULL,\\n\\tFIPS_code char varying (2) NOT NULL\\n);\\n\\n```\\n\\nWe will also need an index on the state code so that we can\\nreference it.\\n\\n\\n```\\nCREATE UNIQUE INDEX us_state_uidx1 on us_state ( state );\\n\\n```\\n\\nThen we need to populate the state table with states.  Please cut-and-paste\\nthis or use the supplied file to insert the states.\\n\\n```\\nINSERT INTO us_state ( state_name, state, FIPS_code ) values\\n\\t('Alabama','AL','01'),\\n\\t('Alaska','AK','02'),\\n\\t('Arizona','AZ','04'),\\n\\t('Arkansas','AR','05'),\\n\\t('California','CA','06'),\\n\\t('Colorado','CO','08'),\\n\\t('Connecticut','CT','09'),\\n\\t('Delaware','DE','10'),\\n\\t('District of Columbia','DC','11'),\\n\\t('Florida','FL','12'),\\n\\t('Georgia','GA','13'),\\n\\t('Hawaii','HI','15'),\\n\\t('Idaho','ID','16'),\\n\\t('Illinois','IL','17'),\\n\\t('Indiana','IN','18'),\\n\\t('Iowa','IA','19'),\\n\\t('Kansas','KS','20'),\\n\\t('Kentucky','KY','21'),\\n\\t('Louisiana','LA','22'),\\n\\t('Maine','ME','23'),\\n\\t('Maryland','MD','24'),\\n\\t('Massachusetts','MA','25'),\\n\\t('Michigan','MI','26'),\\n\\t('Minnesota','MN','27'),\\n\\t('Mississippi','MS','28'),\\n\\t('Missouri','MO','29'),\\n\\t('Montana','MT','30'),\\n\\t('Nebraska','NE','31'),\\n\\t('Nevada','NV','32'),\\n\\t('New Hampshire','NH','33'),\\n\\t('New Jersey','NJ','34'),\\n\\t('New Mexico','NM','35'),\\n\\t('New York','NY','36'),\\n\\t('North Carolina','NC','37'),\\n\\t('North Dakota','ND','38'),\\n\\t('Ohio','OH','39'),\\n\\t('Oklahoma','OK','40'),\\n\\t('Oregon','OR','41'),\\n\\t('Pennsylvania','PA','42'),\\n\\t('Puerto Rico','PR','72'),\\n\\t('Rhode Island','RI','44'),\\n\\t('South Carolina','SC','45'),\\n\\t('South Dakota','SD','46'),\\n\\t('Tennessee','TN','47'),\\n\\t('Texas','TX','48'),\\n\\t('Utah','UT','49'),\\n\\t('Vermont','VT','50'),\\n\\t('Virginia','VA','51'),\\n\\t('Virgin Islands','VI','78'),\\n\\t('Washington','WA','53'),\\n\\t('West Virginia','WV','54'),\\n\\t('Wisconsin','WI','55'),\\n\\t('Wyoming','WY','56')\\n;\\n\\n```\\n\\nNow let's make the relationship between them know to the database.\\nThis is called a foreign key constraint.\\n\\n```\\nALTER TABLE name_list \\n\\tADD CONSTRAINT name_list_state_fk\\n\\tFOREIGN KEY (state) \\n\\tREFERENCES us_state (state)\\n;\\n\\n```\\n\\nNow when we try to insert data that is has an invalid state code\\ninto our list of names it will get rejected.\\n\\nThe following SQL will *not* run successfully\\n\\n```\\ninsert into name_list ( real_name, state ) values\\n\\t( 'nobody', 'XX' )\\n;\\n```\\n\\nYou should get an error that looks similar to:\\n\\n```\\nERROR:  insert or update on table \\\"name_list\\\" violates foreign key constraint \\\"name_list_state_fk\\\"\\nDETAIL:  Key (state)=(XX) is not present in table \\\"us_state\\\".\\n```\\n\\n#### Tags: \\\"foreign key\\\",\\\"alter table\\\",\\\"add constraint\\\"\\n\\n\\n\", \"Lesson_no\": 9}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.48139+0000",
		"video_img": "hw09.jpg",
		"video_url": "hw09.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.48358+0000",
		"homework_id": "897b9257-aebf-4b50-7ea7-1027b0ff0d3c",
		"homework_no": "10",
		"homework_title": " Interactive - 10 - add a index on the name table",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 10 - add a index on the name table\\n\\nWe have already added indexes but we need to make this process explicit.\\n\\nThe most common indexes are based on special kind of tree called a b-tree.\\n\\nIt is a very wide tree that allows us to get to the data stored on disk\\nquickly.  This is not the only kind of index.\\n\\nThere are indexes for other things that are built into PostgreSQL.\\n\\nLet's create an index on the real_name field.\\n\\nThe general form for the create index looks like:\\n\\n```\\ncreate [unique] index \u003cindex-name\u003e on \u003ctable-name\u003e (\\n\\t\u003ccolunm-name-1\u003e,\\n\\t\u003ccol-2\u003e,\\n\\t...\\n);\\n```\\n\\nSo...\\n\\n```\\nCREATE INDEX name_list_idx1 on name_list ( real_name );\\n\\n```\\n\\nNow when we search for a name it will use the index to help to find the\\nnames in the table.  If we have a million names in many blocks of data\\nit will only take a few blocks of index search to get to the row with\\nthe name we are interested in.\\n\\nThe disadvantage is that we have to have the exact name to search on.\\nDo you remember our lower-case name, `bob true` from the 2nd homework.\\nIf we look for that we will not find it at all because we fixed the\\nname to be `Bob True`.\\n\\n\\n```\\nselect * from name_list where real_name = 'bob true';\\n\\n```\\n\\nIndexes are important because this is the primary way that we can\\ninfluence the performance of a database.   If we add the word \\\"unique\\\"\\nthen it also grantees that a column of data is unique.\\n\\nNote that we can build indexes on more than one column.  If that is\\nthe case then a for a select to use the multi-column index will\\nrequire that all of the columns in the index are in the where \\nclause.\\n\\nIndexes are also used when we sort data to get it back in order.\\nWe will return to this subject of sorting data in a future\\nhomework.\\n\\n\\n#### Tags: \\\"create index\\\"\\n\\n\", \"Lesson_no\": 10}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.4879+0000",
		"video_img": "hw10.jpg",
		"video_url": "hw10.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.48987+0000",
		"homework_id": "3c0d812e-fd9a-4968-46b0-c3b36129336a",
		"homework_no": "11",
		"homework_title": " Interactive - 11 - add a index on the name table that is case insensitive.",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 11 - add a index on the name table that is case insensitive.\\n\\nLet's address the case sensitive problem first.\\n\\nWe can create indexes on functions of data.  This allows us to have\\nan index where we convert the upper/lower case to all lower case\\nand then index this result.\\n\\n```\\nCREATE INDEX user_real_name_ci_idx1 ON name_list ((lower(real_name)));\\n\\n```\\n\\nNow when we search the table using the WHERE clause we can use the `lower()` function on\\nboth sides of the equal and use the index to find the data.\\n\\n```\\nSELECT * \\n\\tFROM name_list \\n\\tWHERE lower(real_name) = lower('Bob True')\\n;\\n\\n```\\n\\nIndexes are also a disadvantage.  Every insert of a row now requires an insert\\nto each of the indexes.  They take up storage space.   This means that we are\\nusing space and time at data insert or update to save time when we select the\\ndata back.  Most interactive databases have 10 to 20 times as many selects\\nas they do insert/update operations.   So this is usually a good tried off.\\n\\nWe can also get the database to tell us the set of indexes that are not\\nused.  We may want to get rid of unused indexes.  We can do that with\\n\\n```\\ndrop index \u003cindex_name\u003e;\\n```\\n\\nCare should be taken.  If the index is a \\\"UNIQUE\\\" index and you remove it\\nyou are also removing the unique constraint on the column of data.\\n\\nLet's get rid of the index that is upper-lower case on the table.\\n\\n```\\ndrop index name_list_idx1;\\n```\\n\\nThis is the query that I used to find unused indexes (it's a bit complicated):\\nWe will use this in a homework on database performance later in the class.\\n\\n```\\nSELECT\\n    idstat.relname AS TABLE_NAME,\\n    indexrelname AS INDEX_NAME,\\n    idstat.idx_scan AS index_scans_count,\\n    pg_size_pretty(pg_relation_size(indexrelid)) AS index_size,\\n    tabstat.idx_scan AS table_reads_index_count,\\n    tabstat.seq_scan AS table_reads_seq_count,\\n    tabstat.seq_scan + tabstat.idx_scan AS table_reads_count,\\n    n_tup_upd + n_tup_ins + n_tup_del AS table_writes_count,\\n    pg_size_pretty(pg_relation_size(idstat.relid)) AS table_size\\nFROM pg_stat_user_indexes AS idstat\\n\\tJOIN pg_indexes ON indexrelname = indexname\\n\\t\\t\\tAND idstat.schemaname = pg_indexes.schemaname\\n\\tJOIN pg_stat_user_tables AS tabstat ON idstat.relid = tabstat.relid\\nWHERE indexdef !~* 'unique'\\nORDER BY\\n    idstat.idx_scan DESC,\\n    pg_relation_size(indexrelid) DESC\\n;\\n\\n```\\n\\nPlease cut/past the above query and run it once.\\n\\n\\nThings to note:\\n\\n1. The index name has to be unique.\\n2. You can have more than one index on a table.\\n3. Function based indexes require that the function be run on every insert.  That takes time.\\n4. We can create our own functions and index on them as well.   We will return to this subject later with `soundex()`\\n\\n#### Tags: index,\\\"create index\\\",\\\"lower\\\"\\n\\n\", \"Lesson_no\": 11}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.49934+0000",
		"video_img": "hw11.jpg",
		"video_url": "hw11.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.50166+0000",
		"homework_id": "b29de643-4918-4a40-7cf3-0d5d90fda2cd",
		"homework_no": "12",
		"homework_title": " Interactive - 12 - fix our duplicate data",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 12 - fix our duplicate data\\n\\nNow that we have a unique primary key we can fix the duplicate name and its row.\\n\\n```\\nSELECT * from name_list;\\n\\n```\\n\\nThis shows us 2 rows and we would like to delete just one of them.  Without the unique\\nprimary key this is really hard to do.  With the key we can delete one of the two rows.\\n\\nThis makes for a complex query.   First let's select the UUID column, name_list_id\\nwhere the duplicate is.\\n\\n\\n```\\nSELECT name_list_id\\n\\tFROM name_list \\n\\tWHERE real_name = 'Jane True'\\n;\\n\\n```\\n\\nNow let's just select 1 of the IDs. To do this we have to convert the UUID to text,\\nthat is the `::text` so that we can use a function `min()` on it.  This is kind of\\na random pick - but it will give us just 1 UUID.\\n\\n\\n```\\nSELECT min(name_list_id::text)\\n\\tFROM name_list \\n\\tWHERE real_name = 'Jane True'\\n;\\n\\n```\\n\\nNow we can delete and skip over the 1 UUID that we picked from above.  This is\\nthe `not in` portion - where we put a select inside the delete.\\n\\n\\n```\\nDELETE FROM name_list\\n\\tWHERE real_name = 'Jane True'\\n\\t  AND name_list_id::text not in (\\n\\t\\tSELECT min(name_list_id::text)\\n\\t\\tFROM name_list \\n\\t\\tWHERE real_name = 'Jane True'\\n\\t)\\n;\\n\\n```\\n\\nNow select again and we have removed the duplicate.\\n\\n```\\nSELECT * from name_list;\\n\\n```\\n\\n#### Tags: \\\"duplicate data\\\",\\\"delete\\\",\\\"type cast\\\",\\\"min\\\",\\\"not in\\\"\\n\\n\", \"Lesson_no\": 12}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.51829+0000",
		"video_img": "hw12.jpg",
		"video_url": "hw12.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.52015+0000",
		"homework_id": "21b4dc44-6e85-4efb-4c63-9b59e3a154ee",
		"homework_no": "13",
		"homework_title": " Interactive - 13 - drop both tables",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 13 - drop both tables\\n\\nLet's try getting rid of our 2 tables.   Our first attempt to do this will fail.\\n\\n```\\ndrop table us_state;\\n```\\n\\nWe have a dependency via foreign constraint on us_state.  That is name_list.\\n\\nWe can do this in order - or we can use an option to \\\"cascade\\\" the drops.\\n\\\"cascade\\\" is powerful but dangerous.  In PosgreSQL it will drop the table\\nand associated constraints.  In Oracle it cascades to the tables referenced!\\n\\n\\n```\\n\\nDROP table name_list;\\nDROP table us_state;\\n\\n\\n```\\n\\n\\n\\nNow use the supplied script to re-create the tables.  There will be some additional\\ncolumns when you do this that we will use in future homework exercises.\\n\\nThe file is hw13_4.sql - run the entire file.  The file is show below.   After you\\nhave run the file do the select to see a table of the states.\\n\\n```\\n\\nDROP TABLE if exists name_list cascade ;\\nDROP TABLE if exists us_state cascade ;\\n\\nCREATE TABLE us_state (\\n\\tstate_id       UUID NOT NULL DEFAULT uuid_generate_v4() primary key,\\n\\tstate_name     text NOT NULL,\\n\\tstate          char varying (2) NOT NULL,\\n\\tFIPS_code      char varying (2) NOT NULL,\\n\\tarea_rank      int not null default 9999,\\n\\tarea_sq_mi     numeric not null default 0,\\n\\tpopulation     int not null default 0,\\n\\tfed_area       int   not null default 0,\\n\\tgdp_growth     float null default 0.0,\\n\\tgdp            float null default 0.0\\n);\\n\\nCREATE UNIQUE INDEX us_state_uidx1 on us_state ( state );\\n\\n\\nINSERT INTO us_state\\n    ( state_name,             state,  FIPS_code,  population, area_rank, area_sq_mi, fed_area, gdp_growth, gdp ) values\\n\\t( 'Alabama',               'AL',     '01' ,      4903185,        25,      50750,     6,         2.0,   196.9  ),\\n\\t( 'Alaska',                'AK',     '02' ,       731545,         1,     570641,    12,        -0.3,    52.3  ),\\n\\t( 'Arizona',               'AZ',     '04' ,      7278717,         6,     113642,    12,         4.0,   309.1  ),\\n\\t( 'Arkansas',              'AR',     '05' ,      3017825,        27,      52075,     8,         0.9,   115.9  ),\\n\\t( 'California',            'CA',     '06' ,     39512223,         3,     155973,    12,         3.5,  2700.0  ),\\n\\t( 'Colorado',              'CO',     '08' ,      5758736,         8,     103730,    10,         3.5,   336.4  ),\\n\\t( 'Connecticut',           'CT',     '09' ,      3565387,        48,       4845,     1,         1.0,   242.2  ),\\n\\t( 'Delaware',              'DE',     '10' ,       973764,        50,       1955,     3,         0.3,    63.9  ),\\n\\t( 'District of Columbia',  'DC',     '11' ,       705749,        52,        137,     5,         3.2,  125.94  ),\\n\\t( 'Florida',               'FL',     '12' ,     21477737,        26,      53997,     6,         3.5,   917.0  ),\\n\\t( 'Georgia',               'GA',     '13' ,     10617423,        21,      57919,     6,         2.6,   522.4  ),\\n\\t( 'Hawaii',                'HI',     '15' ,      1415872,        47,       6423,    12,         1.0,    80.8  ),\\n\\t( 'Idaho',                 'ID',     '16' ,      1787065,        11,      82751,    12,         4.1,    69.9  ),\\n\\t( 'Illinois',              'IL',     '17' ,     12671821,        24,      55593,     7,         2.1,   764.2  ),\\n\\t( 'Indiana',               'IN',     '18' ,      6732219,        38,      35870,     7,         1.9,   326.1  ),\\n\\t( 'Iowa',                  'IA',     '19' ,      3155070,        23,      55875,     7,         1.4,   170.7  ),\\n\\t( 'Kansas',                'KS',     '20' ,      2913314,        13,      81823,    10,         1.9,   152.3  ),\\n\\t( 'Kentucky',              'KY',     '21' ,      4467673,        36,      39732,     8,         1.4,   186.1  ),\\n\\t( 'Louisiana',             'LA',     '22' ,      4648794,        33,      43566,    11,         1.1,   231.2  ),\\n\\t( 'Maine',                 'ME',     '23' ,      1344212,        39,      30865,     1,         1.9,    56.7  ),\\n\\t( 'Maryland',              'MD',     '24' ,      6045680,        42,       9775,     5,         1.6,   367.9  ),\\n\\t( 'Massachusetts',         'MA',     '25' ,      6949503,        45,       7838,     1,         2.7,   501.3  ),\\n\\t( 'Michigan',              'MI',     '26' ,      9986857,        22,      56539,     7,         2.7,   468.4  ),\\n\\t( 'Minnesota',             'MN',     '27' ,      5639632,        14,      79617,     9,         2.2,   331.4  ),\\n\\t( 'Mississippi',           'MS',     '28' ,      2976149,        31,      46914,     6,         1.0,   101.6  ),\\n\\t( 'Missouri',              'MO',     '29' ,      6137428,        18,      68898,     8,         2.3,   282.2  ),\\n\\t( 'Montana',               'MT',     '30' ,      1068778,         4,     145556,     9,         0.9,    44.8  ),\\n\\t( 'Nebraska',              'NE',     '31' ,      1934408,        15,      76878,    10,         1.5,   112.2  ),\\n\\t( 'Nevada',                'NV',     '32' ,      3080156,         7,     109806,    12,         3.2,   146.2  ),\\n\\t( 'New Hampshire',         'NH',     '33' ,      1359711,        44,       8969,     1,         2.2,    75.6  ),\\n\\t( 'New Jersey',            'NJ',     '34' ,      8882190,        46,       7419,     5,         2.0,   554.7  ),\\n\\t( 'New Mexico',            'NM',     '35' ,      2096829,         5,     121365,    11,         1.8,    92.6  ),\\n\\t( 'New York',              'NY',     '36' ,     19453561,        30,      47224,     2,         2.1,  1400.0  ),\\n\\t( 'North Carolina',        'NC',     '37' ,     10488084,        29,      48718,     5,         2.9,   496.1  ),\\n\\t( 'North Dakota',          'ND',     '38' ,       762062,        17,      68994,     9,         2.5,    51.2  ),\\n\\t( 'Ohio',                  'OH',     '39' ,     11689100,        35,      40953,     4,         1.8,   601.5  ),\\n\\t( 'Oklahoma',              'OK',     '40' ,      3956971,        19,      68679,    10,         1.8,   193.0  ),\\n\\t( 'Oregon',                'OR',     '41' ,      4217737,        10,      96003,    12,         3.4,   213.7  ),\\n\\t( 'Pennsylvania',          'PA',     '42' ,     12801989,        32,      44820,     4,         2.1,   712.1  ),\\n\\t( 'Puerto Rico',           'PR',     '72' ,      3194000,        49,       3515,     2,         0.4,   101.0  ),\\n\\t( 'Rhode Island',          'RI',     '44' ,      1059361,        51,       1034,     1,         0.6,    53.7  ),\\n\\t( 'South Carolina',        'SC',     '45' ,      5148714,        40,      30111,     5,         1.6,   202.8  ),\\n\\t( 'South Dakota',          'SD',     '46' ,       884659,        16,      75898,     9,         1.3,    45.9  ),\\n\\t( 'Tennessee',             'TN',     '47' ,      6833174,        34,      41220,     6,         3.0,   322.9  ),\\n\\t( 'Texas',                 'TX',     '48' ,     28995881,         2,     261914,    11,         3.2,  1700.0  ),\\n\\t( 'Utah',                  'UT',     '49' ,      3205958,        12,      82168,    12,         4.3,   157.2  ),\\n\\t( 'Vermont',               'VT',     '50' ,       623989,        43,       9249,     1,         1.2,    30.0  ),\\n\\t( 'Virginia',              'VA',     '51' ,      8535519,        37,      39598,     5,         2.4,    71.3  ),\\n\\t( 'Virgin Islands',        'VI',     '78' ,       106977,        53,         68,    12,         0.24,     3.85),\\n\\t( 'Washington',            'WA',     '53' ,      7614893,        20,      66582,    12,         5.7,   506.7  ),\\n\\t( 'West Virginia',         'WV',     '54' ,      1792147,        41,      24087,     5,         2.4,    71.3  ),\\n\\t( 'Wisconsin',             'WI',     '55' ,      5822434,        25,      54314,     7,         2.5,   299.8  ),\\n\\t( 'Wyoming',               'WY',     '56' ,       578759,         9,      97105,    10,         0.3,    38.4  );\\n\\n\\nCREATE TABLE name_list (\\n\\tname_list_id UUID NOT NULL DEFAULT uuid_generate_v4() primary key,\\n\\treal_name text check ( length(real_name) \u003e= 1 ) not null,\\n\\tage int check ( age \u003e 0 and age \u003c 154 ) not  null,\\t\\n\\tstate char varying (2) not null,\\n\\tpay numeric(10,2) \\n);\\n\\nCREATE INDEX name_list_idx1 on name_list ( real_name );\\nCREATE INDEX user_real_name_ci_idx1 ON name_list ((lower(real_name)));\\n\\nALTER TABLE name_list\\n\\tADD CONSTRAINT name_list_state_fk\\n\\tFOREIGN KEY (state)\\n\\tREFERENCES us_state (state)\\n;\\n\\nINSERT INTO name_list ( real_name, age, state, pay ) values\\n\\t( 'Bob True',            22, 'WY', 31000 ),\\n\\t( 'Jane True',           20, 'WY', 28000 ),\\n\\t( 'Tom Ace',             31, 'NJ', 82500 ),\\n\\t( 'Steve Pen',           33, 'NJ', 89400 ),\\n\\t( 'Laura Jean Alkinoos', 34, 'PA', 120000 ),\\n\\t( 'Philip Schlump',      62, 'WY', 101200 ),\\n\\t( 'Liz Trubune',         30, 'WY', 48000 ),\\n\\t( 'Lary Smith',          58, 'NJ', 48000 ),\\n\\t( 'Dave Dave',           21, 'NJ', 48000 ),\\n\\t( 'Laura Ann Alkinoos',  34, 'PA', 48000 )\\n;\\n\\n\\n```\\n\\nYou should have both states and territories with square miles.\\n\\n```\\nSELECT * from us_state;\\n```\\n\\n#### Tags: \\\"reload data\\\",\\\"drop cascade\\\"\\n\\n\\n\\n\", \"Lesson_no\": 13}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.53118+0000",
		"video_img": "hw13.jpg",
		"video_url": "hw13.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.53423+0000",
		"homework_id": "29928fdf-4739-4ac6-5a0c-a547bf360734",
		"homework_no": "14",
		"homework_title": " Interactive - 14 - data types",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 14 - data types\\n\\nThis is really the stuff from chapter 3 in the book.\\n\\nWhen we create a table,  ( Already created in the last homework when you ran the file )\\n\\n```\\nCREATE TABLE us_state (\\n\\tstate_id UUID NOT NULL DEFAULT uuid_generate_v4() primary key,\\n\\tstate_name text NOT NULL,\\n\\tstate char varying (2) NOT NULL,\\n\\tFIPS_code char varying (2) NOT NULL,\\n\\tarea_rank int not null default 9999,\\n\\tarea_sq_mi numeric not null default 0\\n);\\n\\n```\\n\\nwe specify that the columns have a \\\"type\\\" and constraints on the data.\\n\\nThe most common set of types are (ordered from my own code on how frequently I use each type):\\n\\n| Type               | Description                                                           |\\n|--------------------|-----------------------------------------------------------------------|\\n| text               | a string of 0 or more characters.                                     |\\n| varchar(n)         | a string of 0 to `n` characters.                                      |\\n| uuid               | a UUID.                                                               |\\n| date               | a date - not a time.                                                  |\\n| time               | a time value.                                                         |\\n| bigint, int8       | 8 byte integer                                                        |\\n| timestamp          | a date and a time - usually with a time zone.                         |\\n| numeric            | a large number with (think 130k digits, before/after decimal point)   |\\n| decimal            | a large number with (think 130k digits, before/after decimal point)   |\\n| float              | 4 byte - a floating point number with an exponent                     |\\n| real               | 4 byte - a floating point number with an exponent                     |\\n| json, jsonb        | JSON data                                                             |\\n| double precision   | 8 byte - a floating point number with an exponent                     |\\n| bit, varbit        | variable length bit string values                                     |\\n| serial             | a 4 byte auto-generated integer that counts up                        |\\n| interval           | a time interval can be +/- 178million years                           |\\n| bytea              | byte array - binary data                                              |\\n| boolean            | true/false                                                            |\\n| point, line        | geometric data                                                        |\\n| box, path          | geometric data                                                        |\\n| polygon, cirlce    | geometric data                                                        |\\n| tvector, tsquery   | full text search type                                                 |\\n| inet, cidr         | interget address tyeps, IPv4 122.4.3.22 or IPV6                       |\\n| user defined tyeps | The type system is extensible!                                        |\\n\\t\\n\\nAlso there is a Geographic Information Package for PostgreSQL that is very good.\\nIt is built on top of the geometric data types and GIN indexes.   \\n\\nWe are not going to use all of these types.  Just a few of the most common ones like timestamp.\\n\\nOften we want a column to show when a new row is inserted or updated in a table.\\nLet's add these to our name_list table.\\n\\n```\\nalter table name_list add updated timestamp ;\\nalter table name_list add created timestamp \\n\\tdefault current_timestamp not null  ;\\n\\n```\\n\\nTo make the 'updated' column work we need have PostgreSQL run some\\ncode when an update happens.  This kind of a thing is called a \\\"trigger\\\".\\n\\nLet's add a trigger to the table.  \\nRun the file `hw14_2.sql`.  The contents of the file is shown below.\\n\\n\\n```\\n\\nCREATE OR REPLACE function name_list_upd()\\nRETURNS trigger AS \\n$$\\nBEGIN\\n  NEW.updated := current_timestamp;\\n  RETURN NEW;\\nEND\\n$$\\nLANGUAGE 'plpgsql';\\n\\n\\nCREATE TRIGGER name_list_trig\\nBEFORE update ON name_list\\nFOR EACH ROW\\nEXECUTE PROCEDURE name_list_upd();\\n\\n\\n```\\n\\n\\nNow when we do an update on this table it will set the updated field\\nto the current time.\\n\\n\\n#### Tags: \\\"data types\\\"\\n\", \"Lesson_no\": 14}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.53812+0000",
		"video_img": "hw14.jpg",
		"video_url": "hw14.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.54017+0000",
		"homework_id": "97969e65-84f4-4231-49e7-9d3649611fb7",
		"homework_no": "15",
		"homework_title": " Interactive - 15 - select with group data of data",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 15 - select with group data of data\\n\\nSQL has the ability to group data.  When we use the count() function\\nwe are grouping by data.  You can only group by data that you\\nselect - you can not group by hidden columns.   However you can\\nuse a nested select to pick just some of the columns after you\\nhave grouped.  The last part of this homework will show this.\\nFirst we have to group the data.\\n\\n```\\nSELECT \\n\\t\\tfed_area,\\n\\t\\tmin(gdp_growth) as max_growth,\\n\\t\\tavg(gdp_growth) as avg_growth,\\n\\t\\tmax(gdp_growth) as min_growth,\\n\\t\\tstring_agg(state, ',' ORDER BY state) as  state_list\\n\\tFROM us_state\\n\\tGROUP BY fed_area\\n\\tORDER BY fed_area\\n;\\n\\n```\\n\\nYou can group by more than one column.  All the non-grouped columns\\nhave to be in some form aggregated.   In this example we have min, max, avg\\nand string_agg.\\n\\nTo group columns the database has to sort them.  So an order by is usually\\nfree.  If you group by a column that there is a b-tree index on the group\\nby is much faster.   The database will use the index instead of re-sorting\\nthe data.  Other index types do not provide sorted data (gin, gist, hash etc).\\n\\nLet's say we just want the avg_growth and the list of states.  We\\nhave to have fed_area to do the grouping - but we can nest\\nour select.\\n\\n\\n```\\nSELECT t1.avg_growth, t1.state_list\\n\\tFROM (\\n\\t\\tSELECT \\n\\t\\t\\t\\tt2.fed_area,\\n\\t\\t\\t\\tavg(t2.gdp_growth) as avg_growth,\\n\\t\\t\\t\\tstring_agg(t2.state, ',' ORDER BY state) as  state_list\\n\\t\\t\\tFROM us_state as t2\\n\\t\\t\\tGROUP BY t2.fed_area\\n\\t) as t1\\n;\\n\\n```\\n\\n## Take Away\\n\\n1. group by\\n2. order by\\n3. min/avg/max\\n4. nested selects in FROM\\n4. Aliasing tables int the \\\"FROM\\\" with \\\"as\\\"\\n\\n## Book\\n\\n- group by - page 120 to 121\\n- min, max - page 119\\n- avg - 64, 195\\n- order by - page 15, 16\\n- alias table name - page 86\\n- nested query in From - page 195 (avg used also)\\n\\n#### Tags: \\\"min\\\",\\\"max\\\",\\\"avg\\\",\\\"group by\\\",\\\"order by\\\",\\\"nested query\\\",\\\"sub query\\\"\\n\\n\", \"Lesson_no\": 15}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.55926+0000",
		"video_img": "hw15.jpg",
		"video_url": "hw15.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.5614+0000",
		"homework_id": "ede933b8-9242-47da-5c8b-f4e791a8945f",
		"homework_no": "16",
		"homework_title": " Interactive - 16 - count matching rows in a select",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 16 - count matching rows in a select\\n\\nYou can count stuff that is grouped.   This turns out to be very useful.\\n\\nSuppose that we want to know how many states are in a group and the\\nsum of the population in the group.\\n\\n```\\nSELECT \\n\\t\\tfed_area,\\n\\t\\tround(avg(gdp_growth)::numeric,2)::text||'%' as avg_growth,\\n\\t\\tsum(population) as sum_population,\\n\\t\\tcount(state) as no_of_states,\\n\\t\\tstring_agg(state, ',' ORDER BY state) as  state_list\\n\\tFROM us_state\\n\\tGROUP BY fed_area\\n\\tORDER BY 2 desc\\n;\\n\\n```\\n\\nYou should get 12 rows order by decreasing average growth.\\n\\n\\n\\n\\n## Take Away\\n\\n1. You can count the number of rows in the group with count.\\n2. You can order by a column position this is the \\\"2 desc\\\".\\n3. The function round() takes a numeric argument - but the output of avg() is a double precision float.  A type cast is used.\\n4. You can convert from the numeric result of round to text with a \\\"::text\\\" type cast - then add the '%' to show it is a percentage.\\n\\n\\n\\n## Book\\n\\n- group by - page 120 to 121\\n- avg - 64\\n- order by - page 15, 16\\n\\n#### Tags: \\\"group by\\\",\\\"avg\\\",\\\"order by\\\"\\n\", \"Lesson_no\": 16}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.56784+0000",
		"video_img": "hw16.jpg",
		"video_url": "hw16.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.5698+0000",
		"homework_id": "f3cf1b03-f905-4d7d-4811-78463b17345d",
		"homework_no": "17",
		"homework_title": " Interactive - 17 - select with join ( inner join, left outer join )",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 17 - select with join ( inner join, left outer join )\\n\\nSQL starts to get fun, and become a programming task as soon\\nas we have more than one table.\\n\\nWe have already seen a join between name_list and us_state based\\non state code.  Let's get specific on how joins work and how\\nto use them.\\n\\nThe most common join is the \\\"inner\\\" join.   This is when two\\ntables have a common field and we match that field.\\n\\nThe SQL system takes the first table and creates a loop that\\nwill iterate across the 2nd table and where the field matches\\nit connects (joins) the data together.\\n\\nThis is all based on sets of data.\\n\\nSuppose that we have 2 tables, employees and departments.\\n\\n\\n#### Employee Table\\n\\n\\n| Name\\t\\t\\t\\t | Dept Code |  Pay        |\\n|--------------------|-----------|-------------|\\n| Bob                |   1       | $36,000.00  |\\n| Jane               |   1       | $140,000.00 |\\n| Sally              |   2       | $121,000.00 |\\n| Liz                |   2       | $101,000.00 |\\n| Dave               |   1       | $51,000,00  |\\n| CEO Kelly          |   3       | $1.00       |\\n| Uncle Bob          |   NULL    | $96,000.00  |\\n| Brother Charley    |   NULL    | $48,000.00  |\\n\\n\\n#### Department\\n\\n| Department\\t\\t | Dept Code |\\n|--------------------|-----------|\\n| Sales              |   1       |\\n| Development        |   2       |\\n| Executive          |   3       |\\n| Maintenance        |   4       |\\n\\nBoth tables have `Dept_Code` and by matching them\\nup we can find that Sally and Liz and the \\nDevelopment Department.\\n\\nFile: hw17_1.sql\\n\\n\\n```\\n\\nDROP TABLE if exists employee;\\nDROP TABLE if exists department;\\n\\nCREATE TABLE employee (\\n\\temployee_id serial not null primary key,\\n\\tname text not null,\\n\\tdepartment_id  int,\\n\\tpay numeric(12,2) not null default 0\\n);\\n\\nCREATE TABLE department (\\n\\tdepartment_id  serial not null primary key,\\n\\tdept_name text not null\\n);\\n\\nINSERT INTO department ( department_id, dept_name ) values\\n\\t( 1, 'Sales' ),\\n\\t( 2, 'Development' ),\\n\\t( 3, 'Execuatie' ),\\n\\t( 4, 'Maintenance' )\\n;\\n\\nINSERT INTO employee (  name, department_id, pay ) values\\t\\n\\t( 'Bob', 1, 36000 ),\\n\\t( 'Jane', 1, 140000 ),\\n\\t( 'Sally', 2, 121000 ),\\n\\t( 'Liz', 2, 101000 ),\\n\\t( 'Dave', 1, 51000 ),\\n\\t( 'CEO Kelly', 3, 1 ),\\n\\t( 'Uncle Bob', NULL, 96000 ),\\n\\t( 'Brother Charley', NULL, 48000 )\\n;\\n\\n\\n\\n```\\n\\nWe have created the table department with a set of used IDs, 1..4.  We need\\nto update the number generator for the `serial` data to reflect this.\\nIf we don't it will start with 1 and we have already used 1.  We will not\\nbe able to insert data into it.\\n\\nThe command to do this is:\\n\\n```\\nALTER SEQUENCE department_department_id_seq RESTART WITH 5;\\n\\n```\\n\\nHowever you will want to be able to generate this kind of an alter.\\nThe name for the sequence is,  the table name, concatenated with\\nan underscore, then the column name, then `_seq`.\\n\\n## Inner Join \\n\\nThis is the set that both tables have in common.\\n\\n![PostgreSQL Inner Join](PostgreSQL-Inner-Join.png)\\n\\n\\n```\\nselect t1.name as \\\"Employee Name\\\", t2.dept_name as \\\"Department Name\\\", t1.pay \\\"Year pay\\\"\\nfrom employee as t1\\n\\tjoin department as t2 on ( t1.department_id = t2.department_id )\\n;\\n\\n```\\n\\nYou should get back 6 rows.  Note that \\\"Uncle Bob\\\" fails to show up.\\nThis is an inner join - where the common field is not null.\\n\\nNote the double quotes `\\\"` around the column names to allow for upper-lower\\ncase aliases on column names.\\n\\nWe can get the database to fill in NULLs for all the values for\\n`Uncle Bob`.  This is a left outer join.  This is the 2nd most common\\njoin.\\n\\n## Left Outer Join\\n\\nThis is all the rows in the FROM table joined to the right table\\nor NULLs where they don't join.\\n\\n![Left Outer Join](PostgreSQL-Left-Outer-Join.png)\\n\\n```\\nselect t1.name as \\\"Employee Name\\\", t2.dept_name as \\\"Department Name\\\", t1.pay \\\"Year Pay\\\"\\nfrom employee as t1\\n\\tleft outer join department as t2 on ( t1.department_id = t2.department_id )\\n;\\n\\n```\\n\\nNow you should get back 8 rows including \\\"Uncle Bob\\\".\\n\\n\\nNow we can answer the question how many people are not in departments and\\nhow much do they get payed.\\n\\n```\\nselect t1.name as \\\"Employee Name\\\", t2.dept_name as \\\"Department Name\\\", t1.pay \\\"Year Pay\\\"\\nfrom employee as t1\\n\\tleft outer join department as t2 on ( t1.department_id = t2.department_id )\\nwhere t1.department_id is null\\n;\\n\\n```\\n\\nor how much pay is spent on employees not in departments.\\n\\n\\n```\\nselect sum(t0.pay) as \\\"Total Pay\\\"\\nfrom (\\n\\tselect t1.name, t2.dept_name, t1.pay \\n\\tfrom employee as t1\\n\\t\\tleft outer join department as t2 on ( t1.department_id = t2.department_id )\\n\\twhere t1.department_id is null\\n) t0\\n;\\n\\n```\\n\\nInteresting .... That is $144,000.00 payed out to employees that aren't in\\ndepartments.\\n\\n\\nThere are \\\"right\\\" joins but usually I just swap the order of the tables and use the left joins.\\n\\n\\n#### Tags: \\\"inner join\\\",\\\"outer join\\\",\\\"left outer join\\\"\\n\\n\", \"Lesson_no\": 17}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.58051+0000",
		"video_img": "hw17.jpg",
		"video_url": "hw17.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.58314+0000",
		"homework_id": "cd59e967-3e24-4b6e-70d7-5ef73c40485a",
		"homework_no": "18",
		"homework_title": " Interactive - 18 - More joins (full joins)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 18 - More joins (full joins)\\n\\nWe will use the same data (hw17_1.sql)\\n\\n\\n#### Employee Table\\n\\n\\n| Name\\t\\t\\t\\t | Dept Code |  Pay        |\\n|--------------------|-----------|-------------|\\n| Bob                |   1       | $36,000.00  |\\n| Jane               |   1       | $140,000.00 |\\n| Sally              |   2       | $121,000.00 |\\n| Liz                |   2       | $101,000.00 |\\n| Dave               |   1       | $51,000,00  |\\n| CEO Kelly          |   3       | $1.00       |\\n| Uncle Bob          |   NULL    | $96,000.00  |\\n| Brother Charley    |   NULL    | $48,000.00  |\\n\\n\\n#### Department\\n\\n| Department\\t\\t | Dept Code |\\n|--------------------|-----------|\\n| Sales              |   1       |\\n| Development        |   2       |\\n| Executive          |   3       |\\n| Maintenance        |   4       |\\n\\n\\n## Full Join\\n\\nThis is more of a concatenation of rows of data.\\n\\n![Full Outer Join](PostgreSQL-Full-Outer-Join.png)\\n\\n```\\nSELECT t1.name as \\\"Employee Name\\\", t2.dept_name as \\\"Department Name\\\", t1.pay \\\"Year pay\\\"\\nFROM employee as t1\\n\\tFULL JOIN  department as t2 on ( t1.department_id = t2.department_id )\\n;\\n\\n```\\n\\nYou shoudl get back 9 rows - note where the NULL values are.\\n\\n\\n## Full Outer Join - Unique to Both tables Rows\\n\\nYou can also use the join to find the rows that are unique in each table.\\n\\n![PostgreSQL Inner Join](PostgreSQL-Full-Outer-Unique-Join.png)\\n\\n\\n```\\nSELECT t1.name as \\\"Employee Name\\\", t2.dept_name as \\\"Department Name\\\", t1.pay \\\"Year pay\\\"\\nFROM employee as t1\\n\\tFULL JOIN department as t2 on ( t1.department_id = t2.department_id )\\nWHERE t1.name is null \\n   OR t2.dept_name is null\\n;\\n\\n```\\n\\nYou should get back 3 rows.\\n\\n\\n#### Tags: \\\"full join\\\",\\\"full outer join\\\"\\n\\n\", \"Lesson_no\": 18}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.58995+0000",
		"video_img": "hw18.jpg",
		"video_url": "hw18.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.59193+0000",
		"homework_id": "c4ea7444-9d45-4d77-765d-18426ca22f50",
		"homework_no": "19",
		"homework_title": " Interactive - 19 - select using sub-query and exists",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 19 - select using sub-query and exists\\n\\nLet's use some of our joins to delete some data.\\n\\nLet's get rid of the people that are not in a department.\\n\\n```\\nSELECT t0.name as \\\"Employee Name\\\", t0.dept_name as \\\"Department Name\\\", t0.pay \\\"Year Pay\\\"\\nFROM  (\\n\\t\\tSELECT t1.name, t2.dept_name, t1.pay, t1.employee_id\\n\\t\\tFROM employee as t1\\n\\t\\t\\tLEFT OUTER join department as t2 on ( t1.department_id = t2.department_id )\\n\\t\\tWHERE t1.department_id is null\\n\\t\\tORDER BY 1, 3 desc, 4\\n\\t) as t0\\n;\\n\\n```\\n\\nYou should get back 2 rows.\\n\\nThese rows should be the offending rows with the department-less employees.\\n\\n#### Tags: \\\"select exists\\\",\\\"sub-query\\\"\\n\", \"Lesson_no\": 19}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.59989+0000",
		"video_img": "hw19.jpg",
		"video_url": "hw19.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.6493+0000",
		"homework_id": "e2f92fbc-4193-47a1-4fc0-dc6cb623e119",
		"homework_no": "25",
		"homework_title": " Interactive - 25 - drop cascade ",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 25 - drop cascade \\n\\nYou can drop a table or other database object.  This destroys it.\\nPostgreSQL provides the ability to do the \\\"drop\\\" but only if\\nthe object exists.\\n\\n\\n```\\ndrop table name_list;\\n```\\n\\nWill error if the object is not there.\\n\\n```\\n\\ndrop table if exists name_list cascade;\\n\\n```\\n\\n\\nDrop can also detach a table from the set of constraints that it\\nmay have.  This is the \\\"cascade\\\" option to remove foreign\\nkey constraints.  Do note that in Oracle this will drop\\nadditional tables - not just constraints.  Take care with\\n\\\"cascade\\\".\\n\\n\\n```\\ndrop table if exists us_state cascade;\\n\\n```\\n\\n\\nLet's re-create our tables at this point so we have fresh\\ndata for future homework problems.\\n\\nRun the file to re-create : hw13_4.sql\\n\\ndrop table if exists us_state cascade;\\n\\n\\n#### Tags: \\\"drop\\\",\\\"drop cascade\\\"\\n\\n\", \"Lesson_no\": 25}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.65812+0000",
		"video_img": "hw25.jpg",
		"video_url": "hw25.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.65998+0000",
		"homework_id": "bb06327f-3ce3-482e-4a4d-5536e5932c73",
		"homework_no": "26",
		"homework_title": " Interactive - 26 - 1 to 1 relationship  \t\t\t\t(pk to pk)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 26 - 1 to 1 relationship  \\t\\t\\t\\t(pk to pk)\\n\\n\\nThe application uses a small set of user authorization tables from a wrapper application.\\nWe have to create the tables and the tables that match with in the application.\\n\\n\\nOur 1 to 1 relationship is between `\\\"t_ymux_user\\\"` and our application table\\n`ct_login`.    ct_login privies extra application specific columns that every user has\\nto have.\\n\\nWe are just going to create all 6 tables - then explore the relationships.\\n\\n\\n\\n\\n\\n3 Tables From The Security Application\\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\n\\nThe Tables are \\\"t_ymux_user\\\" , \\\"ct_homework_ans\\\"  and  \\\"t_ymux_user_log\\\" .\\n\\n\\nRun the file hw26_01.sql\\n\\n```\\nDROP TABLE if exists \\\"t_ymux_user\\\" cascade ;\\n\\nCREATE TABLE \\\"t_ymux_user\\\" (\\n\\t  \\\"id\\\"\\t\\t\\t\\t\\tuuid DEFAULT uuid_generate_v4() not null primary key\\n\\t, \\\"username\\\" \\t\\t\\ttext\\n\\t, \\\"password\\\" \\t\\t\\ttext\\n\\t, \\\"realm\\\" \\t\\t\\t\\ttext\\n\\t, \\\"real_name\\\" \\t\\t\\ttext\\n\\t, \\\"salt\\\" \\t\\t\\t\\ttext\\n\\t, \\\"email\\\" \\t\\t\\t\\ttext\\n\\t, \\\"email_confirmed\\\" \\tchar varying (1) default 'n' not null\\n\\t, \\\"setup_2fa_complete\\\" \\tchar varying (1) default 'n' not null\\n\\t, \\\"rfc_6238_secret\\\"\\t\\ttext -- if not null then this supports auth with RFC 6238 hmac/hash time based 2fa.\\n\\t, \\\"recovery_token\\\" \\t\\ttext\\n\\t, \\\"recovery_expire\\\" \\ttimestamp\\n\\t, \\\"parent_user_id\\\"\\t\\tuuid\\n\\t, \\\"org_user_id\\\"\\t\\t\\tuuid\\n\\t, \\\"auth_token\\\"\\t\\t\\ttext -- if this is an auth-token based device login\\n\\t, \\\"acct_expire\\\" \\t\\ttimestamp\\n\\t, \\\"updated\\\" \\t\\t\\ttimestamp\\n\\t, \\\"created\\\" \\t\\t\\ttimestamp default current_timestamp not null\\n);\\nCOMMENT ON TABLE \\\"t_ymux_user\\\" IS 'version: m4_ver_version() tag: m4_ver_tag() build_date: m4_ver_date()';\\n\\n\\ncreate unique index \\\"t_ymux_user_u1\\\" on \\\"t_ymux_user\\\" ( \\\"username\\\" );\\ncreate index \\\"t_ymux_user_p1\\\" on \\\"t_ymux_user\\\" ( \\\"email\\\" );\\ncreate unique index \\\"t_ymux_user_u3\\\" on \\\"t_ymux_user\\\" ( \\\"recovery_token\\\" );\\ncreate index \\\"t_ymux_user_p2\\\" on \\\"t_ymux_user\\\" ( \\\"created\\\", \\\"setup_2fa_complete\\\" );\\ncreate index \\\"t_ymux_user_p3\\\" on \\\"t_ymux_user\\\" ( \\\"created\\\", \\\"email_confirmed\\\" );\\n\\n\\n\\n\\nCREATE OR REPLACE function t_ymux_user_upd()\\nRETURNS trigger AS $$\\nBEGIN\\n\\t-- version: b14871d878aa2f9fbaa35f4ad2c6c2baf9584c06 tag: v0.1.9 build_date: Fri Dec 11 14:30:43 MST 2020\\n\\tNEW.updated := current_timestamp;\\n\\tRETURN NEW;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\nCREATE TRIGGER t_ymux_user_trig\\nBEFORE update ON \\\"t_ymux_user\\\"\\nFOR EACH ROW\\nEXECUTE PROCEDURE t_ymux_user_upd();\\n\\n```\\n\\nRun the file hw26_02.sql\\n\\n```\\n\\n-- -------------------------------------------------------- -- --------------------------------------------------------\\n-- Note the \\\"auth_token\\\" is the \\\"ID\\\" for this row. (Primnary Key)\\n-- -------------------------------------------------------- -- --------------------------------------------------------\\n\\ndrop TABLE if exists \\\"t_ymux_auth_token\\\" ;\\nCREATE TABLE \\\"t_ymux_auth_token\\\" (\\n\\t  \\\"id\\\"\\t\\t\\t\\t\\tuuid DEFAULT uuid_generate_v4() not null primary key\\n\\t, \\\"user_id\\\"\\t\\t\\t\\tuuid not null\\n\\t, \\\"updated\\\" \\t\\t\\ttimestamp\\n\\t, \\\"created\\\" \\t\\t\\ttimestamp default current_timestamp not null\\n);\\nCOMMENT ON TABLE \\\"t_ymux_auth_token\\\" IS 'version: b14871d878aa2f9fbaa35f4ad2c6c2baf9584c06 tag: v0.1.9 build_date: Fri Dec 11 14:30:43 MST 2020';\\n\\ncreate index \\\"t_ymux_auth_token_p1\\\" on \\\"t_ymux_auth_token\\\" ( \\\"user_id\\\" );\\ncreate index \\\"t_ymux_auth_token_p2\\\" on \\\"t_ymux_auth_token\\\" ( \\\"created\\\" );\\n\\n\\nALTER TABLE \\\"t_ymux_auth_token\\\"\\n\\tADD CONSTRAINT \\\"t_ymux_auth_token_user_id_fk1\\\"\\n\\tFOREIGN KEY (\\\"user_id\\\")\\n\\tREFERENCES \\\"t_ymux_user\\\" (\\\"id\\\")\\n;\\n\\nCREATE OR REPLACE function t_ymux_auth_token_upd()\\nRETURNS trigger AS $$\\nBEGIN\\n\\t-- version: b14871d878aa2f9fbaa35f4ad2c6c2baf9584c06 tag: v0.1.9 build_date: Fri Dec 11 14:30:43 MST 2020\\n\\tNEW.updated := current_timestamp;\\n\\tRETURN NEW;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\nCREATE TRIGGER t_ymux_auth_token_trig\\nBEFORE update ON \\\"t_ymux_auth_token\\\"\\nFOR EACH ROW\\nEXECUTE PROCEDURE t_ymux_auth_token_upd();\\n\\n```\\n\\nRun the file hw26_03.sql\\n\\n```\\nCREATE SEQUENCE t_log_seq\\n  INCREMENT 1\\n  MINVALUE 1\\n  MAXVALUE 9223372036854775807\\n  START 1\\n  CACHE 1;\\n\\nDROP TABLE if exists \\\"t_ymux_user_log\\\" ;\\n\\nCREATE TABLE \\\"t_ymux_user_log\\\" (\\n\\t  \\\"id\\\"\\t\\t\\t\\t\\tuuid DEFAULT uuid_generate_v4() not null primary key\\n\\t, \\\"user_id\\\"\\t\\t\\t\\tuuid \\t-- if null then a failed event\\n\\t, \\\"seq\\\"\\t \\t\\t\\t\\tbigint DEFAULT nextval('t_log_seq'::regclass) NOT NULL \\n\\t, \\\"activity_name\\\"\\t\\ttext\\n\\t, \\\"updated\\\" \\t\\t\\ttimestamp\\n\\t, \\\"created\\\" \\t\\t\\ttimestamp default current_timestamp not null\\n);\\nCOMMENT ON TABLE \\\"t_ymux_user_log\\\" IS 'version: b14871d878aa2f9fbaa35f4ad2c6c2baf9584c06 tag: v0.1.9 build_date: Fri Dec 11 14:30:43 MST 2020';\\n\\ncreate index \\\"t_ymux_user_log_p1\\\" on \\\"t_ymux_user_log\\\" ( \\\"user_id\\\", \\\"seq\\\" );\\ncreate index \\\"t_ymux_user_log_p2\\\" on \\\"t_ymux_user_log\\\" ( \\\"user_id\\\", \\\"created\\\" );\\n\\nALTER TABLE \\\"t_ymux_user_log\\\"\\n\\tADD CONSTRAINT \\\"t_ymux_user_log_user_id_fk1\\\"\\n\\tFOREIGN KEY (\\\"user_id\\\")\\n\\tREFERENCES \\\"t_ymux_user\\\" (\\\"id\\\")\\n;\\n\\nCREATE OR REPLACE function t_ymux_user_log_upd()\\nRETURNS trigger AS $$\\nBEGIN\\n\\t-- version: b14871d878aa2f9fbaa35f4ad2c6c2baf9584c06 tag: v0.1.9 build_date: Fri Dec 11 14:30:43 MST 2020\\n\\tNEW.updated := current_timestamp;\\n\\tRETURN NEW;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\nCREATE TRIGGER t_ymux_user_log_trig\\nBEFORE update ON \\\"t_ymux_user_log\\\"\\nFOR EACH ROW\\nEXECUTE PROCEDURE t_ymux_user_log_upd();\\n\\n```\\n\\n\\n\\n\\n## Applications Tables\\n\\n\\\"t_ymux_user\\\" joins to ct_login on a 1 to 1 basis.  Each time a user is inserted\\ntinto ct_login a set of rows is populated for all the homework that exits into\\nct_homework_ans.\\n\\n\\nct_login\\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\n\\nRun the file hw26_04.sql\\n\\n```\\nDROP TABLE if exists ct_login ;\\nCREATE TABLE ct_login (\\n\\t  user_id\\t\\t\\t\\t\\tuuid not null primary key -- 1 to 1 to \\\"t_ymux_user\\\".\\\"id\\\"\\n\\t, pg_acct\\t\\t\\t\\t\\tchar varying (20) not null\\n\\t, class_no\\t\\t\\t\\t\\ttext default '4010-BC' not null\\t-- 4280 or 4010-BC - one of 2 classes\\n\\t, lang_to_use\\t\\t\\t\\ttext default 'Go' not null\\t\\t-- Go or PostgreSQL\\n\\t, misc\\t\\t\\t\\t\\t\\tJSONb default '{}' not null\\t\\t-- Whatever I forgot\\n);\\n\\ncreate unique index ct_login_u1 on ct_login ( pg_acct );\\ncreate index ct_login_p1 on ct_login using gin ( misc );\\n\\nALTER TABLE ct_login\\n\\tADD CONSTRAINT ct_login_user_id_fk\\n\\tFOREIGN KEY (user_id)\\n\\tREFERENCES \\\"t_ymux_user\\\" (\\\"id\\\")\\n;\\n\\n```\\n\\n\\nct_homeowrk\\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\n\\nRun the file hw26_05.sql\\n\\n```\\nDROP TABLE if exists ct_homework cascade;\\n\\nCREATE TABLE ct_homework (\\n\\t  homework_id\\t\\t\\t\\tuuid DEFAULT uuid_generate_v4() not null primary key\\n\\t, homework_title\\t\\t\\ttext not null\\n\\t, lesson_no\\t\\t\\t\\t\\ttext not null\\n\\t, points_avail\\t\\t\\t\\tint not null default 10\\n\\t, video_url\\t\\t\\t\\t\\ttext not null\\n\\t, video_img\\t\\t\\t\\t\\ttext not null\\n\\t, lesson_body \\t\\t\\t\\tJSONb not null \\t-- body, html, text etc.\\n);\\n\\nCREATE INDEX ct_homework_p1 on ct_homework ( homework_no );\\n\\n```\\n\\nct_homeowrk_ans\\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\n\\nRun the file hw26_06.sql\\n\\n```\\nDROP TABLE if exists ct_homework_ans ;\\nCREATE TABLE ct_homework_ans (\\n\\t  homework_ans_id\\t\\t\\tuuid DEFAULT uuid_generate_v4() not null primary key\\n\\t, homework_id\\t\\t\\t\\tuuid not null\\n\\t, user_id\\t\\t\\t\\t\\tuuid not null\\n\\t, points\\t\\t\\t\\t\\tint not null default 0\\n\\t, completed\\t\\t\\t\\t\\tchar(1) default 'n' not null\\n\\t, updated\\t\\t \\t\\t\\ttimestamp\\n\\t, created \\t\\t\\t\\t\\ttimestamp default current_timestamp not null\\n);\\n\\n\\ncreate unique index ct_homework_ans_u1 on ct_homework_ans ( homework_id, user_id );\\ncreate unique index ct_homework_ans_u2 on ct_homework_ans ( user_id, homework_id );\\n\\n\\n-- homework_id is fk to ct_homework\\nALTER TABLE ct_homework_ans\\n\\tADD CONSTRAINT homework_id_fk\\n\\tFOREIGN KEY (homework_id)\\n\\tREFERENCES ct_homework (homework_id)\\n;\\n\\n-- user_id is fk to ct_login\\nALTER TABLE ct_homework_ans\\n\\tADD CONSTRAINT user_id_fk\\n\\tFOREIGN KEY (user_id)\\n\\tREFERENCES ct_login (user_id)\\n;\\n\\n\\nCREATE OR REPLACE function ct_homework_ans_upd()\\nRETURNS trigger AS $$\\nBEGIN\\n\\tNEW.updated := current_timestamp;\\n\\tRETURN NEW;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\nCREATE TRIGGER ct_homework_ans_trig\\nBEFORE update ON ct_homework_ans\\nFOR EACH ROW\\nEXECUTE PROCEDURE ct_homework_ans_upd();\\n\\n\\n```\\n\\nTriggers that depend on multiple tables\\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\n\\nRun the file hw26_07.sql\\n\\n```\\nCREATE OR REPLACE function ct_homework_ins()\\nRETURNS trigger AS $$\\nBEGIN\\n\\tinsert into ct_homework_ans (\\n\\t\\tuser_id,\\n\\t\\thomework_id\\n\\t) select \\n\\t\\tt1.user_id,\\n\\t\\tNEW.homework_id\\n\\tfrom ct_login as t1\\n\\twhere not exists (\\n\\t\\t\\tselect 1 as \\\"found\\\"\\n\\t\\t\\tfrom ct_homework_ans t2\\n\\t\\t\\twhere t2.user_id = t1.user_id\\t\\t\\t\\n\\t\\t\\t  and t2.homework_id = NEW.homework_id\\n\\t\\t)\\n\\t;\\n\\tRETURN NEW;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\nDROP TRIGGER if exists ct_homework_trig_ins_upd on ct_homework;\\n\\nCREATE TRIGGER ct_homework_trig_ins_upd\\nBEFORE insert or update ON ct_homework\\nFOR EACH ROW\\nEXECUTE PROCEDURE ct_homework_ins();\\n\\n\\n\\n\\n\\n\\nCREATE OR REPLACE function ct_homework_del()\\nRETURNS trigger AS $$\\nBEGIN\\n\\tupdate ct_homework_ans t3\\n\\t\\tset completed = 'x'\\n\\t\\twhere t3.homework_id = NEW.homework_id\\n\\t\\t  and t3.completed = 'n'\\n\\t;\\n\\tRETURN OLD;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\nDROP TRIGGER if exists ct_homework_trig_del on ct_homework;\\n\\nCREATE TRIGGER ct_homework_trig_del\\nBEFORE delete ON ct_homework\\nFOR EACH ROW\\nEXECUTE PROCEDURE ct_homework_del();\\n\\n\\n\\n\\n\\n\\n\\n\\nCREATE OR REPLACE function ct_login_ins()\\nRETURNS trigger AS $$\\nBEGIN\\n\\tinsert into ct_homework_ans (\\n\\t\\tuser_id,\\n\\t\\thomework_id\\n\\t) select \\n\\t\\tNEW.user_id,\\n\\t\\tt1.homework_id\\n\\tfrom ct_homework as t1\\n\\twhere not exists (\\n\\t\\t\\tselect 1 as \\\"found\\\"\\n\\t\\t\\tfrom ct_homework_ans t2\\n\\t\\t\\twhere t2.user_id = NEW.user_id\\t\\t\\t\\n\\t\\t\\t  and t2.homework_id = t1.homework_id\\n\\t\\t)\\n\\t;\\n\\tRETURN NEW;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\ndrop TRIGGER if exists ct_login_trig on ct_login;\\n\\nCREATE TRIGGER ct_login_trig\\nBEFORE insert ON ct_login\\nFOR EACH ROW\\nEXECUTE PROCEDURE ct_login_ins();\\n\\n```\\n\\n\\nHomework tags\\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\n\\nRun the file hw26_09.sql and hw26_10.sql\\n\\n```\\n\\nDROP TABLE IF EXISTS ct_tag ;\\n\\nCREATE TABLE ct_tag ( \\n\\ttag_id uuid DEFAULT uuid_generate_v4() not null primary key,\\n\\ttag_word text not null\\n);\\n\\nCREATE UNIQUE INDEX ct_tag_p1 on ct_tag ( tag_word );\\n\\n\\n\\nDROP TABLE IF EXISTS ct_tag_homework ;\\n\\nCREATE TABLE ct_tag_homework ( \\n\\ttag_id \\t\\tuuid not null,\\n\\thomework_id uuid not null,\\n\\tprimary key ( homework_id, tag_id )\\n);\\n\\nCREATE UNIQUE INDEX ct_tag_homework_u1 on ct_tag_homework ( tag_id, homework_id );\\n\\n\\n```\\n\\nSetup default data\\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\n\\n\\nRun the file hw26_11.sql to setup data for these tables.\\n\\n\\n```\\n\\nselect setup_data_26();\\n\\n\\n```\\n\\n\\n\\n#### Tags: \\\"setup\\\",\\\"ct_homework\\\",\\\"ct_homework_ans\\\",\\\"ct_tag\\\",\\\"ct_tag_homework\\\",\\\"t_ymux_user\\\",\\\"t_ymux_user_log\\\",\\\"t_ymux_auth_token\\\"\\n\\n\\n\\n\\n\", \"Lesson_no\": 26}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.69332+0000",
		"video_img": "hw26.jpg",
		"video_url": "hw26.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.60188+0000",
		"homework_id": "6ddcb91a-d01e-49d8-78a3-a2dc1498a579",
		"homework_no": "20",
		"homework_title": " Interactive - 20 - delete with in based sub-query",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 20 - delete with in based sub-query\\n\\nLet's use some of our joins to delete some data.\\n\\nWe will recreate the data from homework 17 again.  The file is hw17_1.sql\\n\\n```\\n\\nDROP TABLE if exists employee;\\nDROP TABLE if exists department;\\n\\nCREATE TABLE employee (\\n\\temployee_id serial not null primary key,\\n\\tname text not null,\\n\\tdepartment_id  int,\\n\\tpay numeric(12,2) not null default 0\\n);\\n\\nCREATE TABLE department (\\n\\tdepartment_id  serial not null primary key,\\n\\tdept_name text not null\\n);\\n\\nINSERT INTO department ( department_id, dept_name ) values\\n\\t( 1, 'Sales' ),\\n\\t( 2, 'Development' ),\\n\\t( 3, 'Execuatie' ),\\n\\t( 4, 'Maintenance' )\\n;\\n\\nINSERT INTO employee (  name, department_id, pay ) values\\t\\n\\t( 'Bob', 1, 36000 ),\\n\\t( 'Jane', 1, 140000 ),\\n\\t( 'Sally', 2, 121000 ),\\n\\t( 'Liz', 2, 101000 ),\\n\\t( 'Dave', 1, 51000 ),\\n\\t( 'CEO Kelly', 3, 1 ),\\n\\t( 'Uncle Bob', NULL, 96000 ),\\n\\t( 'Brother Charley', NULL, 48000 )\\n;\\n\\n\\n\\n```\\n\\n\\nLet's get rid of the people that are not in a department.\\n\\n```\\nDELETE FROM employee as t0\\n\\tWHERE t0.employee_id in (\\n\\t\\tSELECT t1.employee_id\\n\\t\\tFROM employee as t1\\n\\t\\t\\tLEFT OUTER join department as t2 on ( t1.department_id = t2.department_id )\\n\\t\\tWHERE t1.department_id is null\\n\\t)\\n;\\n\\n```\\n\\nIt should delete 2 rows.\\n\\nThere are performance reasons to use either exists or in.  Exists combines the queries and is better when the tables are similar in size.\\nIn is usually better when the left table is much smaller than the parent table.  In results in the inside query running to completion\\nbefore the outside query.\\n\\n\\n#### Tags: \\\"delete exists\\\",\\\"sub-query\\\"\\n\", \"Lesson_no\": 20}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.60819+0000",
		"video_img": "hw20.jpg",
		"video_url": "hw20.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.61027+0000",
		"homework_id": "ae30a109-4341-4b58-72bb-51ad0dbf5fee",
		"homework_no": "21",
		"homework_title": " Interactive - 21 - select with union / minus",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 21 - select with union / minus\\n\\nYou can concatenate results with a \\\"UNION\\\" between two selects.  This can be kind of like a full join\\nbut instead of getting back nulls you can fill in values that you like.\\n\\n```\\n\\tSELECT t1.name as \\\"Employee Name\\\", 'No Departmnt' \\\"Department Name\\\", t1.pay \\\"Year Pay\\\"\\n\\tFROM employee as t1\\n\\tWHERE t1.department_id is null\\nUNION\\n\\tSELECT 'No Name' as \\\"Employee Name\\\", t2.dept_name as \\\"Department Name\\\", 0.0 \\\"Year Pay\\\"\\n\\tFROM department as t2 \\nORDER BY 1\\n;\\n\\n```\\n\\nYou should get back 4 rows.\\n\\n#### Tags: \\\"union\\\"\\n\\n\\n\", \"Lesson_no\": 21}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.61491+0000",
		"video_img": "hw21.jpg",
		"video_url": "hw21.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.61684+0000",
		"homework_id": "bb2d52a1-551d-4340-77a3-6a85480ae211",
		"homework_no": "22",
		"homework_title": " Interactive - 22 - recursive select - populating existing tables ",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 22 - recursive select - populating existing tables \\n\\nIt is also possible to store and query recursive data.   You need a table\\nwith and \\\"id\\\" and a \\\"parent_id\\\" that referees back to the same table.\\n\\n```\\nCREATE TABLE tree_example (\\n\\tid  \\t\\t\\tint not null primary key,\\n\\tmanager_id  \\tint,\\n\\tname \\t\\t\\ttext\\n);\\n\\nINSERT INTO tree_example ( id, name, manager_id ) values\\n\\t(1, 'Michael North', NULL),\\n\\t(2, 'Megan Berry', 1),\\n\\t(3, 'Sarah Berry', 1),\\n\\t(4, 'Zoe Black', 1),\\n\\t(5, 'Tim James', 1),\\n\\t(6, 'Bella Tucker', 2),\\n\\t(7, 'Ryan Metcalfe', 2),\\n\\t(8, 'Max Mills', 2),\\n\\t(9, 'Benjamin Glover', 2),\\n\\t(10, 'Carolyn Henderson', 3),\\n\\t(11, 'Nicola Kelly', 3),\\n\\t(12, 'Alexandra Climo', 3),\\n\\t(13, 'Dominic King', 3),\\n\\t(14, 'Leonard Gray', 4),\\n\\t(15, 'Eric Rampling', 4),\\n\\t(16, 'Piers Paige', 7),\\n\\t(17, 'Ryan Henderson', 7),\\n\\t(18, 'Frank Tucker', 8),\\n\\t(19, 'Nathan Ferguson', 8),\\n\\t(20, 'Kevin Rampling', 8)\\n;\\n\\n\\n```\\n\\nNow we can to a recursive query.   In PostgreSQL they are composed of a base query\\nunironed with all the children.\\n\\n```\\nWITH RECURSIVE subordinates AS (\\n\\t\\tSELECT\\n\\t\\t\\tid,\\n\\t\\t\\tmanager_id,\\n\\t\\t\\tname\\n\\t\\tFROM tree_example\\n\\t\\tWHERE id = 2\\n\\tUNION\\n\\t\\tSELECT\\n\\t\\t\\te.id,\\n\\t\\t\\te.manager_id,\\n\\t\\t\\te.name\\n\\t\\tFROM tree_example e\\n\\t\\tINNER JOIN subordinates s ON s.id = e.manager_id\\n) SELECT * FROM subordinates\\n;\\n\\n```\\n\\n#### Tags: \\\"recursive select\\\",recursive\\n\\n\", \"Lesson_no\": 22}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.62425+0000",
		"video_img": "hw22.jpg",
		"video_url": "hw22.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.6265+0000",
		"homework_id": "d4844e73-1fbc-4c96-6f79-cd3431c4e92f",
		"homework_no": "23",
		"homework_title": " Interactive - 23 - with - pre-selects to do stuff.",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 23 - with - pre-selects to do stuff.\\n\\nYou can run queries before your main query and give the results names.\\nThese are run in order and that can have substantial advantages.\\n\\nThe general syntax is\\n\\n```\\nwith\\n\\ttemp_name as ( select ... )\\n\\nselect stufff.\\n\\n\\tfrom  temp_name\\n\\n;\\n```\\n\\n```\\nWITH\\n\\tmystery_employess as ( select sum(pay) total_pay  from name_list where state = 'WY' ),\\n\\tnormal_employees as ( select sum(pay) total_pay from name_list where state in ( 'NJ', 'NY' ) )\\nSELECT round( ( tWY.total_pay / ( tWY.total_pay + tEast.total_pay ) ) * 100.0, 2)  as relative_pay\\nFROM \\n\\tmystery_employess  as tWY\\n\\t, normal_employees  as tEast\\n;\\n\\n```\\n\\n\\nYou should get back a single row of data that tells you that in Wyoming you get 43% as much pay\\nas a job in NY or NJ (Note that the data in this example is not totally accurate.  Also you have\\na much lower cost of living in Wyoming than you do in NY NY.)\\n\\n#### Tags: \\\"with\\\",\\\"with select\\\"\\n\\n\\n\", \"Lesson_no\": 23}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.6347+0000",
		"video_img": "hw23.jpg",
		"video_url": "hw23.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.63675+0000",
		"homework_id": "e5c4aacb-3906-41bf-7589-db99dae562cd",
		"homework_no": "24",
		"homework_title": " Interactive - 24 - truncate table",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 24 - truncate table\\n\\nPostgreSQL (and most other SQL databases, Oracle, DB/2, DB/2 Universal etc)\\nprovide the ability to discard ALL the data in a table.     This is implemented\\nas a re-write of the table header info and putting all the data in the table\\non the re-claim block list.  So it is linear time(fast).\\n\\nAlso it is a part of the Data Definition Language (not Data Manipulation)\\nso it often can not be used in a transaction.  It can not be rolled back\\nif the transaction fails.\\n\\nAlso when you use truncate stuff like triggers for delete will not fire.\\n\\n```\\nTRUNCATE TABLE name_list;\\nSELECT count(1) from name_list;\\n\\n```\\n\\nYou should get back 0 rows.\\n\\n#### Tags: \\\"truncate\\\",\\\"fast delete\\\",\\\"delete all rows\\\"\\n\\n\", \"Lesson_no\": 24}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.64755+0000",
		"video_img": "hw24.jpg",
		"video_url": "hw24.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.69474+0000",
		"homework_id": "f54d03ce-b092-43ea-43ee-17e5194f9e47",
		"homework_no": "27",
		"homework_title": " Interactive - 27 - 1 to 0 or 1 relationship \t\t\t(fk, unique)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 27 - 1 to 0 or 1 relationship \\t\\t\\t(fk, unique)\\n\\nNow that we have our tables let's look at the relationship between\\n`\\\"t_ymx_user\\\"` and \\\"ct_login\\\".   This is our 1 to 0 or 1 relationship.\\n\\nIt is provided by the primary key on ct_login being required but not\\nhaving a default value where a key is generated.   This is combined\\nwith the foreign key constraint to `\\\"t_ymux_user\\\"`.\\n\\nTry an insert to see if you can fake it out (the insert will fail).\\n\\n```\\ninsert into ct_login ( user_id, pg_acct ) values ( uuid_generate_v4(), 'x' );\\n\\n```\\n\\nYou should get an error.   The error indicates that you violated a foreign key and will look similar to:\\n\\n```\\nERROR:  insert or update on table \\\"ct_homework_ans\\\" violates foreign key constraint \\\"user_id_fk\\\"\\nDETAIL:  Key (user_id)=(ce1d8fdd-aa04-4bb4-9ef7-72655ff63b95) is not present in table \\\"ct_login\\\".\\nCONTEXT:  SQL statement \\\"insert into ct_homework_ans (\\n\\t\\tuser_id,\\n\\t\\thomework_id\\n\\t) select\\n\\t\\tNEW.user_id,\\n\\t\\tt1.homework_id\\n\\tfrom ct_homework as t1\\n\\twhere not exists (\\n\\t\\t\\tselect 1 as \\\"found\\\"\\n\\t\\t\\tfrom ct_homework_ans t2\\n\\t\\t\\twhere t2.user_id = NEW.user_id\\n\\t\\t\\t  and t2.homework_id = t1.homework_id\\n\\t\\t)\\\"\\nPL/pgSQL function ct_login_ins() line 3 at SQL statement\\n```\\n\\n#### Tags: \\\"1 to 0\\\",\\\"1:0\\\",\\\"1:0 relationship\\\",\\\"1:1\\\"\\n\\n\", \"Lesson_no\": 27}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.70243+0000",
		"video_img": "hw27.jpg",
		"video_url": "hw27.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.70338+0000",
		"homework_id": "2df9858f-3432-4649-6d63-01693df10257",
		"homework_no": "28",
		"homework_title": " Interactive - 28 - 1 to n relationship\t\t\t\t(fk)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 28 - 1 to n relationship\\t\\t\\t\\t(fk)\\n\\nThe simple to understand relationship is a 1 to 0..n relationship.\\nThis is where a parent key is a primary key and a foreign key\\nis in a 2nd table.  We have this relationship between\\n`\\\"t_ymux_user\\\".\\\"id\\\"` and the `\\\"t_ymux_auth_token\\\"`.\\n\\nThe table `\\\"t_ymux_auth_token\\\"` has \\\"user_id\\\" as a column in it.\\nA foreign key relationship exists between the 2 tables.  This means\\nthat you can have more than 1 auth token for each user.   Basically\\na user can login from more than one computer at a time.\\n\\n```\\nselect setup_data_26();\\n\\nselect t1.email, t2.id as \\\"auth_token\\\"\\nfrom \\\"t_ymux_user\\\" as t1\\n\\tjoin \\\"t_ymux_auth_token\\\" as t2 on ( t1.\\\"id\\\" = t2.\\\"user_id\\\" )\\n;\\n\\n```\\n\\nYou should get back 3 rows.\\n\\n#### Tags: \\\"1:n\\\",\\\"1:n relationship\\\"\\n\\n\", \"Lesson_no\": 28}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.7077+0000",
		"video_img": "hw28.jpg",
		"video_url": "hw28.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.7087+0000",
		"homework_id": "39998c61-0186-472f-7386-aacbda033ea7",
		"homework_no": "29",
		"homework_title": " Interactive - 29 - m to n relationship\t\t\t\t(fk to join table to fk)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 29 - m to n relationship\\t\\t\\t\\t(fk to join table to fk)\\n\\nOur model has a m to n (m:n) relationship in it.  This is between ct_homeowrk\\nand ct_tags.\\n\\nThis relationship requires an intermediate table.  Each side has a relationship\\nto the intermediate table.\\n\\n\\nct_tag associates a tag_word with a tag_id  (Shown below - the table was created\\nin the script in homework 26 - you don't need to run it.)\\n\\n```\\nCREATE TABLE ct_tag ( \\n\\ttag_id uuid DEFAULT uuid_generate_v4() not null primary key,\\n\\ttag_word text not null\\n);\\n\\nCREATE UNIQUE INDEX ct_tag_p1 on ct_tag ( tag_word );\\n```\\n\\nTo get  a list of the words do a select from this table.\\n\\n```\\nselect tag_word from ct_tag order by tag_word;\\n\\n```\\n\\nNote that tag_word has a unique index on it.  This prevents any duplicate tags.\\n\\nThe join table has just IDs in it.   To make it efficient it has indexes that\\ngo in both directions - this allows searching from ct_tags back to ct_homework\\nand from ct_homework to ct_tags.    One of the unique indexes is the multi-field\\nprimary key with homework_id, tag_id in it..   This is listed at the bottom\\nof the create table.  The second one is a unique index.\\n\\n(shown below - do not run, just for reference)\\n\\n```\\nCREATE TABLE ct_tag_homework ( \\n\\ttag_id \\t\\tuuid not null,\\n\\thomework_id uuid not null,\\n\\tprimary key ( homework_id, tag_id )\\n);\\n\\nCREATE UNIQUE INDEX ct_tag_homework_u1 on ct_tag_homework ( tag_id, homework_id );\\n```\\n\\nThe ct_homework table (show for reference) is:\\n\\n\\n```\\n\\nCREATE TABLE ct_homework (\\n\\t  homework_id\\t\\t\\t\\tuuid DEFAULT uuid_generate_v4() not null primary key\\n\\t, homework_no\\t\\t\\t\\ttext not null\\n\\t, points_avail\\t\\t\\t\\tint not null default 10\\n\\t, video_url\\t\\t\\t\\t\\ttext not null\\n\\t, video_img\\t\\t\\t\\t\\ttext not null\\n\\t, lesson_body \\t\\t\\t\\tJSONb not null \\t-- body, html, text etc.\\n);\\n\\nCREATE INDEX ct_homework_p1 on ct_homework ( homework_no );\\n```\\n\\n\\nNow do a select from the join table.\\n\\n\\n```\\nselect * from ct_tag_homework order by 1, 2;\\n\\n```\\n\\n## Creative Homework (40pts)\\n\\nConstruct a select that joins all 3 tables together.  The select should have\\n`homework_title` and `points_avail` from the ct_homework table in it.\\nIt should also have the `tag_word`  from ct_tag and it should join from\\nct_homework to ct_tag_homework to ct_tag.   The output should be an ordered\\nlist of homework and all the tags that are associated with each homework.\\nFor example in homework 29 you should have 3 tags, \\\"m to n\\\", \\\"m:n\\\" and\\n\\\"m:n relationship\\\" as the tags.    Also have the tags sorted alphabetically.\\nThis means that \\\"m to n\\\" will be the last of the 3 tags for homework 29.\\n\\nHints:  You need to sort by a column that you do not need to return.\\nThis is the homework_no.   So you need to have a sub-select with\\nthe order by on the inside select.\\nThe example of a join is in homework 19 where we use a sub-select and\\nthe order by on the inside select.\\n\\nIn homework 11 we have an example of jointing to multiple tables at\\nonce.\\n\\nThe homework on inner joins is 18.\\n\\nIt's important that the sort order by homework_no be done as an\\ninteger, not as text.  You will need to use a `::int` to convert\\nthe text field to an integer field.\\n\\nThe correct output data should look similar to:\\n\\n```\\n                                      homework_title                                      |      tag_word      \\n------------------------------------------------------------------------------------------+--------------------\\n  Interactive - 01 - Create Table                                                         | create table\\n  Interactive - 01 - Create Table                                                         | hw01\\n  Interactive - 01 - Create Table                                                         | type int\\n  Interactive - 01 - Create Table                                                         | type text\\n  Interactive - 01 - Create Table                                                         | type varchar\\n  Interactive - 02 - Insert data into \\\"name_list\\\"                                         | hw02\\n  Interactive - 02 - Insert data into \\\"name_list\\\"                                         | insert\\n...\\n...\\n...\\n  Interactive - 08 - create unique id and a primary key                                   | UUID\\n  Interactive - 09 - add a table with state codes                                         | add constraint\\n  Interactive - 09 - add a table with state codes                                         | alter table\\n  Interactive - 09 - add a table with state codes                                         | foreign key\\n  Interactive - 10 - add a index on the name table                                        | create index\\n  Interactive - 11 - add a index on the name table that is case insensitive.              | create index\\n...\\n...\\n...\\n\\n```\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n#### Tags: \\\"m to n\\\",\\\"m:n\\\",\\\"m:n relationship\\\"\\n\\n\", \"Lesson_no\": 29}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.71462+0000",
		"video_img": "hw29.jpg",
		"video_url": "hw29.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.71583+0000",
		"homework_id": "41df2841-5b36-4377-55b0-2d2e2f19a71d",
		"homework_no": "30",
		"homework_title": " Interactive - 30 - 1 to ordered list relationship\t\t(fk to uk with sequence)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 30 - 1 to ordered list relationship\\t\\t(fk to uk with sequence)\\n\\n\\nThe model has a 1 to a list of rows.  This is a more unusual relationship\\nbecause the list can be ordered by time.  Usually relationships in a SQL\\ndatabase are not inherently ordered.  In  this case we use a sequence \\ngenerated number to make the set of rows in a specific order.\\n\\n\\nTaken from hw26_3.sql that you have already run.\\nYou don't have to run it again.\\nThe first step is to create a sequence.   This one is `t_log_seq`.\\nEach time a value is used from the sequenced it increments.\\n\\n\\n```\\nCREATE SEQUENCE t_log_seq\\n  INCREMENT 1\\n  MINVALUE 1\\n  MAXVALUE 9223372036854775807\\n  START 1\\n  CACHE 1;\\n\\n```\\n\\nFor the field \\\"seq' in the table we use the sequence.  This is\\nthe `nextval('t_log_seq'::regclass)` default value.  When we insert\\nwe allow the default value to fill `seq`.   Our join is a 1:n join\\nbased on user_id to the user.  Each time a security event happens\\nwe insert the type of event to this table.   In a complete\\nsecurity system this kind of a \\\"log\\\" has a trigger on it and\\nfor certain events it would generate an email to the user.  An\\nexample is the creation of a device/application account or the\\nchange of the account password.   Some events would just be logged\\nfor later statistical usage - like a login or logout event.\\n\\nAlso taken from hw26_3.sql that you have already run.\\nYou don't have to run it again.\\n\\n```\\nCREATE TABLE \\\"t_ymux_user_log\\\" (\\n\\t  \\\"id\\\"\\t\\t\\t\\t\\tuuid DEFAULT uuid_generate_v4() not null primary key\\n\\t, \\\"user_id\\\"\\t\\t\\t\\tuuid \\t-- if null then a failed event\\n\\t, \\\"seq\\\"\\t \\t\\t\\t\\tbigint DEFAULT nextval('t_log_seq'::regclass) NOT NULL \\n\\t, \\\"activity_name\\\"\\t\\ttext\\n\\t, \\\"updated\\\" \\t\\t\\ttimestamp\\n\\t, \\\"created\\\" \\t\\t\\ttimestamp default current_timestamp not null\\n);\\n\\ncreate index \\\"t_ymux_user_log_p1\\\" on \\\"t_ymux_user_log\\\" ( \\\"user_id\\\", \\\"seq\\\" );\\ncreate index \\\"t_ymux_user_log_p2\\\" on \\\"t_ymux_user_log\\\" ( \\\"user_id\\\", \\\"created\\\" );\\n```\\n\\nRun a simple select on t_ymux_user_log.  You should have at least 2 rows in\\nit.\\n\\n```\\nselect * from t_ymux_user_log;\\n```\\n\\n\\n## Assignment 03 - Create 2 tables.   \\n\\n50 points.\\n\\nCreate a table a \\\"issue\\\" table that has a text body column called \\\"body\\\".\\nThe table needs to have a UUID primary key that is automatically generated.\\nThen create a child table, \\\"issue_note\\\" that has a list of comments with dates associated\\nwith the \\\"issue\\\" table.   This list of comments needs to be ordered using\\na \\\"seq\\\" column.   Create a sequence to support this column.  Call the sequence \\\"t_issue_note_seq\\\".\\nBoth tables need to have created/updated columns that are date stamps.\\n\\nTurn in the source code for creating the tables with some inserts that put \\ndata into the tables and a select that verifies an issue and a set of\\nissue notes.\\n\\nDon't loose your source code for these tables.\\nWe will use these tables in the assignment on key word search later in the class.\\n\\n\\n\\n#### Tags: \\\"1 to list\\\",\\\"list of rows\\\"\\n\\n\", \"Lesson_no\": 30}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.72012+0000",
		"video_img": "hw30.jpg",
		"video_url": "hw30.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.7212+0000",
		"homework_id": "9781b82b-a9a9-4410-59b9-8a09e5d1633e",
		"homework_no": "31",
		"homework_title": " Interactive - 31 - only one row of data\t\t\t\t(uk with no sequence)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 31 - only one row of data\\t\\t\\t\\t(uk with no sequence)\\n\\nWith system configuration tables it is often useful to only have 1 row of data.\\nEach configuration item is a distinct column in the table.\\n\\nThis can be done with a primary key and a constraint.     The constraint limits the values\\non the primary key and results in an error if a attempt to insert a 2nd row occurs.\\n\\nIn this example we just have `applicaiton_name` as the single configuration item.\\n\\n```\\ncreate table ct_config (\\n\\tconfig_id serial primary key check ( config_id = 1 ),\\n\\tapplication_name text\\n);\\n\\n```\\n\\nThe first insert will work.  Then 2nd will not.\\n\\n```\\ninsert into ct_config ( application_name ) values ( '4280 class' );\\n\\n\\n```\\n\\nand 2nd insert\\n\\n```\\ninsert into ct_config ( application_name ) values ( '4010 blockchain class' );\\n\\n```\\n\\non the 2nd insert you should get an error similar to:\\n\\n```\\npsql:hw31_3.sql:3: ERROR:  new row for relation \\\"ct_config\\\" violates check constraint \\\"ct_config_config_id_check\\\"\\nDETAIL:  Failing row contains (2, 4010 blockchain class).\\n```\\n\\nWe can prevent delete of the row with a trigger.\\n\\n\\n```\\nCREATE OR REPLACE FUNCTION ct_config_prevent_delete() \\nRETURNS trigger AS $$\\nBEGIN            \\n\\tIF OLD.config_id = 1 THEN\\n\\t\\tRAISE EXCEPTION 'cannot delete configuration row';\\n\\tEND IF;\\nEND;\\n$$ \\nLANGUAGE plpgsql;\\n\\nCREATE TRIGGER ct_config_prevent_delete \\nBEFORE DELETE ON ct_config\\nFOR EACH ROW EXECUTE PROCEDURE ct_config_prevent_delete();\\n\\n\\n```\\n\\nWhen you try to delete:\\n\\n```\\ndelete from ct_config;\\n```\\n\\nYou should get an error similar to:\\n\\n```\\nERROR:  cannot delete configuration row\\nCONTEXT:  PL/pgSQL function ct_config_prevent_delete() line 4 at RAISE\\n\\n```\\n\\n\\n#### Tags: \\\"single row\\\",\\\"raise exception\\\",\\\"trigger\\\",\\\"delete trigger\\\"\\n\\n\", \"Lesson_no\": 31}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.72887+0000",
		"video_img": "hw31.jpg",
		"video_url": "hw31.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.72986+0000",
		"homework_id": "7f5f5115-bc74-437d-6103-1da2aa2747a1",
		"homework_no": "32",
		"homework_title": " Interactive - 32 - only one a fixed set of rows.\t\t(pre-papulae with key, pk, check-constraint on key)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 32 - only one a fixed set of rows.\\t\\t(pre-papulae with key, pk, check-constraint on key)\\n\\nThere is a different way to implement a set of configuration items.  In this case the items\\nare stored one in each row in a set of fixed rows.\\n\\n\\n```\\nDROP  TABLE if exists ct_config_row ;\\n\\nCREATE TABLE ct_config_row (\\n\\t  id\\t\\t\\t\\tserial not null primary key\\n\\t, name \\t\\t\\t\\ttext not null check ( name in (\\n\\t\\t\\t\\t\\t\\t\\t'security_method',\\n\\t\\t\\t\\t\\t\\t\\t'encryption'\\n\\t\\t\\t\\t\\t\\t) )\\n\\t, ty \\t\\t\\t\\ttext not null default 'str'\\n\\t, value \\t\\t\\ttext \\n\\t, i_value \\t\\t\\tbigint\\n\\t, b_value \\t\\t\\tboolean\\n);\\n\\nCREATE UNIQUE INDEX ct_config_row_p1 on ct_config_row ( name );\\n\\n```\\n\\nWith a table like this we can insert some values:\\n\\n```\\ninsert into ct_config_row ( name, value ) values\\t\\n\\t( 'security_method', 'jwt' ),\\n\\t( 'encryption', 'es' )\\n;\\n\\n```\\n\\nThe fixed set of configuration items is checked with the check constraint\\nand the unique key on name.\\n\\nA trigger can be used to prevent deletion of items.\\n\\n```\\nCREATE OR REPLACE FUNCTION ct_config_row_prevent_delete() \\nRETURNS trigger AS $$\\nBEGIN            \\n\\tIF OLD.config_id = 1 THEN\\n\\t\\tRAISE EXCEPTION 'cannot delete configuration row';\\n\\tEND IF;\\nEND;\\n$$ \\nLANGUAGE plpgsql;\\n\\nCREATE TRIGGER ct_config_row_prevent_delete \\nBEFORE DELETE ON ct_config_row\\nFOR EACH ROW EXECUTE PROCEDURE ct_config_row_prevent_delete();\\n\\n```\\n\\n#### Tags: \\\"fixed set rows\\\",\\\"trigger\\\",\\\"check constraint\\\"\\n\", \"Lesson_no\": 32}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.73481+0000",
		"video_img": "hw32.jpg",
		"video_url": "hw32.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.73571+0000",
		"homework_id": "3043d016-5d01-47e3-6130-27a3f75e7fa6",
		"homework_no": "33",
		"homework_title": " Interactive - 33 - types of indexes (hash, gin)",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 33 - types of indexes (hash, gin)\\n\\nThe default type of index in most SQL databases is a B-Tree.  This is a wide tree\\nthat can produce sorted data based on the data type and ordering of that data.\\n\\nThis is not the only kind of index.  \\n\\nIn some cases ordering of data is meaningless.  For example UUIDs do not have\\nany order.  We will still need to have an index to look up a value but\\nsorting on UUID rarely makes any sense.  A faster index for data that has\\nno order is a \\\"hash\\\" index.\\n\\nAn example of a hash index is:\\n\\n```\\nCREATE INDEX ct_config_row_p2 on ct_config_row USING hash ( value );\\n\\n```\\n\\nHash indexes in PostreSQL do not support unique index constraints.  In versions\\nbefore 13 of PosgreSQL there are other limitations on how indexes are replicated\\nand restored from a backup.\\n\\nAnother type of index is a Generalized Inverse Index or GIN index. This is often\\nused in conjunction with JSONb data types.\\n\\nIn interactive homework 26 part 5 we created a column lesson_body with a data\\ntype of JSONb.  We can create a GIN index on this that will allow for fast \\nsearches of the JSON data.\\n\\n```\\nCREATE INDEX ct_homework_p2 on ct_homework USING gin ( lesson_body );\\n```\\n\\n\\n#### Tags: \\\"index\\\",\\\"gin index\\\",\\\"hash index\\\"\\n\\n\\n\", \"Lesson_no\": 33}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.74058+0000",
		"video_img": "hw33.jpg",
		"video_url": "hw33.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.74157+0000",
		"homework_id": "cf9c992f-96c8-44a3-4c2b-7c786c514839",
		"homework_no": "35",
		"homework_title": " Interactive - 35 - views",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 35 - views\\n\\nThe database can create a pre-defined select called a view.\\nA view is a query that you set up that looks like a table when selected from but\\ncan be a join or other set of operations.  It is kind of like a query-macro.\\n\\nFor example we can create a view that let's us list the unused indexes.\\n\\nThis is the file hw35_1.sql.\\n\\n```\\nCREATE OR REPLACE VIEW unused_index as\\nSELECT\\n    idstat.relname AS TABLE_NAME,\\n    indexrelname AS INDEX_NAME,\\n    idstat.idx_scan AS index_scans_count,\\n    pg_size_pretty(pg_relation_size(indexrelid)) AS index_size,\\n    tabstat.idx_scan AS table_reads_index_count,\\n    tabstat.seq_scan AS table_reads_seq_count,\\n    tabstat.seq_scan + tabstat.idx_scan AS table_reads_count,\\n    n_tup_upd + n_tup_ins + n_tup_del AS table_writes_count,\\n    pg_size_pretty(pg_relation_size(idstat.relid)) AS table_size\\nFROM pg_stat_user_indexes AS idstat\\n\\tJOIN pg_indexes ON indexrelname = indexname\\n\\t\\t\\tAND idstat.schemaname = pg_indexes.schemaname\\n\\tJOIN pg_stat_user_tables AS tabstat ON idstat.relid = tabstat.relid\\nWHERE indexdef !~* 'unique'\\nORDER BY\\n    idstat.idx_scan DESC,\\n    pg_relation_size(indexrelid) DESC\\n;\\n\\n```\\n\\nThen when we want the list of unused indexes we just select from the view.\\n\\n\\n```\\nselect * from unused_index;\\n\\n```\\n\\n\\n#### Tags: view,\\\"unused index\\\"\\n\\n\", \"Lesson_no\": 35}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.74577+0000",
		"video_img": "hw35.jpg",
		"video_url": "hw35.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.7468+0000",
		"homework_id": "6e0f97cc-87cb-4284-51ea-eefbcafe2ebb",
		"homework_no": "36",
		"homework_title": " Interactive - 36 - stored procedures",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 36 - stored procedures\\n\\nWe have been using store procedures for a number of examples so far.    Triggers in\\nPostgreSQL call stored procedures.   In PostgreSQL all stored procedures are called \\\"functions\\\".\\n\\nPostgreSQL allows for stored procedures in multiple languages.   The default language is PL/pgSQL\\nand this us defined using the `LANGUAGE` specifier.  I usually put this at the end but it can\\nbe done at the top also.\\n\\nThe section from $$ to $$ is the body that is saved and run when the function is called.\\n\\nThere are a slew of options on how a function is run.\\n\\n```\\nCREATE or REPLACE FUNCTION function_name ( parameter_list varchar )\\nRETURNS varchar \\nAS $$\\nDECLARE\\n\\tdata text;\\nBEGIN\\n\\n\\t-- do something\\n\\n\\tRETURN data;\\nEND;\\n$$ LANGUAGE plpgsql;\\n```\\n\\nThe easy way to call a function is with a \\\"select\\\".\\nFor example:\\n\\n\\n```\\nselect function_name ( 'a' );\\n```\\n\\nStored procedures have some advantages.  The code is run inside or near to the database.  This makes\\nthe cost of moving data back and forth very low.    Stored procedures are a well developed and optimized\\ntechnology and tend to be fast.  \\n\\nWith PL/pgSQL as the language the data types exactly match with the database and the handling of values\\nlike NULL is clear and easy.\\n\\nWe can check to see if a select fails to return data and for nulls in a fashion that is built into the\\nlanguage.\\n\\n\\n```\\nCREATE or REPLACE FUNCTION function_name ( parameter_list varchar )\\nRETURNS varchar \\nAS $$\\nDECLARE\\n\\tdata text;\\nBEGIN\\n\\n\\tSELECT 'PASS'\\n\\t\\tINTO data\\n\\t\\tFROM ct_config \\n\\t\\tWHERE config_id = 1;\\n\\tIF not found THEN\\n\\t\\tdata = 'FAIL';\\n\\tEND IF;\\n\\n\\tRETURN data;\\nEND;\\n$$ LANGUAGE plpgsql;\\n\\n```\\n\\n\\nIn PostgreSQL a stored procedure creates a transaction at the \\\"BEGIN\\\" and ends it at the\\n\\\"END\\\".  This means that if you \\\"RAISE\\\" an error in the middle it will result in rolling back\\nthe entire transaction.\\n\\nStored procedures can return rows of data.  Note the fact that the loop returns a single\\nrow and then restart's for each additional row.\\n\\nFor example:\\n\\n```\\n-- using table from hw13_4.sql us_state\\n\\nCREATE OR REPLACE FUNCTION getStateFipsCode() \\nRETURNS SETOF us_state \\nAS $$\\nDECLARE\\n    r us_state%rowtype;\\nBEGIN\\n    FOR r IN \\t\\n\\t\\tSELECT * FROM us_state\\n\\t\\tWHERE gdp_growth \u003e 1.0\\n    LOOP\\n\\n        -- can do some processing here\\n\\n        RETURN NEXT r; -- return current row of SELECT\\n    END LOOP;\\n    RETURN;\\nEND\\n$$\\nLANGUAGE 'plpgsql' ;\\n\\nSELECT * \\n\\tFROM getStateFipsCode()\\n;\\n\\n```\\n\\n#### Tags: \\\"function\\\",\\\"stored procedure\\\",\\\"transaction\\\"\\n\\n\", \"Lesson_no\": 36}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.75281+0000",
		"video_img": "hw36.jpg",
		"video_url": "hw36.mp4"
	},
	{
		"created": "2021-01-04T21:33:40.75389+0000",
		"homework_id": "6c9d334c-dd20-4bb4-4310-cd58e1c394a0",
		"homework_no": "37",
		"homework_title": " Interactive - 37 - encrypted/hashed passwords storage",
		"lesson_body": "{\"Lesson\": \"\\n\\n\\n\\n\u003cstyle\u003e\\n.pagebreak { page-break-before: always; }\\n.half { height: 200px; }\\n\u003c/style\u003e\\n\\n\\n\\n\\n\\n\\n\\n\\n# Interactive - 37 - encrypted/hashed passwords storage\\n\\nIt is a good idea to store passwords in a way that if the entire database is lost\\nyou do not loos anybody's password.  You need to hash them or encrypt them\\nin the table.\\n\\nThere are hash functions that are designed for this.  Of of these is  \\nthe blowfish algorithm.  It is denoted to in the encryption parameters as 'bf'.\\n\\n\\nFirst, we need to enable pgcrypto:\\n\\n```\\nCREATE EXTENSION if not exists pgcrypto;\\n\\n```\\n\\n\\nThen, we can create a table for storing user credentials:\\n\\n```\\n\\nDROP TABLE IF EXISTS example_users ;\\n\\nCREATE TABLE example_users (\\n\\tid SERIAL PRIMARY KEY,\\n\\temail TEXT NOT NULL UNIQUE,\\n\\tpassword TEXT NOT NULL\\n);\\n\\n\\nCREATE OR REPLACE function example_users_insert()\\nRETURNS trigger AS $$\\nDECLARE \\n\\tl_salt text;\\n\\tl_pw text;\\nBEGIN\\n\\tselect gen_salt('bf')\\n\\t\\tinto l_salt;\\n\\tl_pw = NEW.password;\\n\\tNEW.password = crypt(l_pw, l_salt);\\n\\tRETURN NEW;\\nEND\\n$$ LANGUAGE 'plpgsql';\\n\\n\\nCREATE TRIGGER example_users_insert_trig\\nBEFORE insert or update ON example_users\\nFOR EACH ROW\\nEXECUTE PROCEDURE example_users_insert();\\n\\n\\n```\\n\\nWhen we insert into the table we can then save the hash of the password instead of the\\npassword itself.\\n\\n```\\nINSERT INTO example_users (email, password) VALUES \\n\\t( 'pschlump@uwyo.edu', 'my-very-bad-password')\\n;\\n\\n```\\n\\nWhen we want to validate that a password that has been passed in is correct\\nwe compare to the hashed value with:\\n\\n\\n```\\nSELECT id \\nFROM example_users as t1\\nWHERE t1.email = 'pschlump@uwyo.edu'\\n  AND t1.password = crypt('my-very-bad-password', t1.password)\\n;\\n\\n```\\n\\nThis would be a good candidate to encapsulate into a stored procedure.\\n\\n```\\nCREATE or REPLACE FUNCTION login_correct ( un varchar, pw varchar )\\nRETURNS varchar \\nAS $$\\nDECLARE\\n\\tdata text;\\nBEGIN\\n\\n\\tBEGIN\\n\\t\\tSELECT 'VALID-USER'\\n\\t\\t\\tINTO data\\n\\t\\t\\tFROM example_users as t1\\n\\t\\t\\tWHERE t1.email = un\\n\\t\\t\\t  AND t1.password = crypt(pw, t1.password)\\n\\t\\t\\t;\\n\\t\\tIF not found THEN\\n\\t\\t\\tdata = 'Incorrect username or password.';\\n\\t\\tEND IF;\\n\\tEXCEPTION\\t\\n\\t\\tWHEN no_data_found THEN\\n\\t\\t\\tdata = 'Incorrect username or password.';\\n\\t\\tWHEN too_many_rows THEN\\n\\t\\t\\tdata = 'Incorrect username or password.';\\n\\t\\tWHEN others THEN\\n\\t\\t\\tdata = 'Incorrect username or password.';\\n\\tEND;\\n\\n\\tRETURN data;\\nEND;\\n$$ LANGUAGE plpgsql;\\n\\nselect login_correct ( 'pschlump@uwyo.edu', 'my-very-bad-password' );\\n\\nselect login_correct ( 'pschlump@uwyo.edu', 'my-VERY-bad-password' );\\n\\n\\n\\n```\\n\\n#### Tags: \\\"password\\\",\\\"hash password\\\",\\\"encrypted\\\"\\n\\n\", \"Lesson_no\": 37}",
		"points_avail": 10,
		"updated": "2021-01-04T21:33:40.75986+0000",
		"video_img": "hw37.jpg",
		"video_url": "hw37.mp4"
	}
]}